2025-09-09 10:32:10 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:25 - 股票代码已从 000063 格式化为 SZ000063
2025-09-09 10:32:12 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:33 - [SZ000063] 获取到 106 条资产负债表数据
2025-09-09 10:35:09 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:25 - 股票代码已从 000063 格式化为 SZ000063
2025-09-09 10:35:12 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:33 - [SZ000063] 获取到 106 条资产负债表数据
2025-09-09 10:37:05 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:25 - 股票代码已从 000063 格式化为 SZ000063
2025-09-09 10:37:07 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:33 - [SZ000063] 获取到 106 条资产负债表数据
2025-09-09 10:37:08 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:71 - [SZ000063] 成功同步 8268 条资产负债表数据
2025-09-09 10:37:36 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:25 - 股票代码已从 000063 格式化为 SZ000063
2025-09-09 10:37:37 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:33 - [SZ000063] 获取到 106 条资产负债表数据
2025-09-09 10:37:39 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:71 - [SZ000063] 成功同步 8268 条资产负债表数据
2025-09-09 10:40:48 | INFO     | core.sync.sync_research_report:sync_stock_research_report:25 - 股票代码已从 000063 格式化为 SZ000063
2025-09-09 10:40:50 | INFO     | core.sync.sync_research_report:sync_stock_research_report:32 - [SZ000063] 获取到 336 条个股研报数据
2025-09-09 10:40:51 | INFO     | core.sync.sync_research_report:sync_stock_research_report:97 - [SZ000063] 成功同步 336 条个股研报数据
2025-09-09 10:43:41 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:25 - 股票代码已从 000063 格式化为 SZ000063
2025-09-09 10:43:42 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:33 - [SZ000063] 获取到 107 条关键指标数据
2025-09-09 10:43:42 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:93 - [SZ000063] 成功同步 107 条关键指标数据
2025-09-09 10:43:57 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:25 - 股票代码已从 000063 格式化为 SZ000063
2025-09-09 10:43:57 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:33 - [SZ000063] 获取到 107 条关键指标数据
2025-09-09 10:43:58 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:93 - [SZ000063] 成功同步 107 条关键指标数据
2025-09-09 10:48:31 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:27 - 股票代码已从 600004 格式化为 SH600004
2025-09-09 10:48:35 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:39 - [SH600004] 获取到 42 条财务指标数据
2025-09-09 10:48:36 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:174 - [SH600004] 成功同步 42 条财务指标数据
2025-09-09 10:48:44 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:27 - 股票代码已从 600004 格式化为 SH600004
2025-09-09 10:48:48 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:39 - [SH600004] 获取到 42 条财务指标数据
2025-09-09 10:48:49 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:174 - [SH600004] 成功同步 42 条财务指标数据
2025-09-09 10:51:22 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:25 - 股票代码已从 000001 格式化为 SZ000001
2025-09-09 10:51:23 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SZ000001] 获取到 63 条股东户数详情数据
2025-09-09 10:51:23 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:100 - [SZ000001] 数据库操作失败: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-09 10:51:23 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:108 - [SZ000001] 获取股东户数详情数据失败: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-09 10:51:23 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:109 - [SZ000001] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Out of range value for column 'total_equity' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.DataError: 1264 (22003): Out of range value for column 'total_equity' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_gdhs.py", line 94, in sync_stock_gdhs
    db.bulk_insert_mappings(StockGdhsDB, gdhs_records)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4661, in bulk_insert_mappings
    self._bulk_save_mappings(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4756, in _bulk_save_mappings
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4744, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.DataError: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

2025-09-09 10:52:37 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:25 - 股票代码已从 000001 格式化为 SZ000001
2025-09-09 10:52:37 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SZ000001] 获取到 63 条股东户数详情数据
2025-09-09 10:52:38 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:100 - [SZ000001] 数据库操作失败: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-09 10:52:38 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:108 - [SZ000001] 获取股东户数详情数据失败: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-09 10:52:38 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:109 - [SZ000001] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Out of range value for column 'total_equity' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.DataError: 1264 (22003): Out of range value for column 'total_equity' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_gdhs.py", line 94, in sync_stock_gdhs
    db.bulk_insert_mappings(StockGdhsDB, gdhs_records)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4661, in bulk_insert_mappings
    self._bulk_save_mappings(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4756, in _bulk_save_mappings
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4744, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.DataError: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

2025-09-09 10:53:30 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:25 - 股票代码已从 000001 格式化为 SZ000001
2025-09-09 10:53:31 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SZ000001] 获取到 63 条股东户数详情数据
2025-09-09 10:53:32 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:100 - [SZ000001] 数据库操作失败: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-09 10:53:32 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:108 - [SZ000001] 获取股东户数详情数据失败: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-09 10:53:32 | ERROR    | core.sync.sync_gdhs:sync_stock_gdhs:109 - [SZ000001] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Out of range value for column 'total_equity' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.DataError: 1264 (22003): Out of range value for column 'total_equity' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_gdhs.py", line 94, in sync_stock_gdhs
    db.bulk_insert_mappings(StockGdhsDB, gdhs_records)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4661, in bulk_insert_mappings
    self._bulk_save_mappings(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4756, in _bulk_save_mappings
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4744, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.DataError: (mysql.connector.errors.DataError) 1264 (22003): Out of range value for column 'total_equity' at row 1
[SQL: INSERT INTO stock_gdhs_data (symbol, end_date, change_range, current_gdhs, previous_gdhs, gdhs_change, gdhs_change_rate, average_hold_value, average_hold_amount, total_market_value, total_equity, equity_change, equity_change_reason, announcement_date, stock_code, stock_name) VALUES (%(symbol)s, %(end_date)s, %(change_range)s, %(current_gdhs)s, %(previous_gdhs)s, %(gdhs_change)s, %(gdhs_change_rate)s, %(average_hold_value)s, %(average_hold_amount)s, %(total_market_value)s, %(total_equity)s, %(equity_change)s, %(equity_change_reason)s, %(announcement_date)s, %(stock_code)s, %(stock_name)s)]
[parameters: [{'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 1), 'change_range': 43.94506866, 'current_gdhs': 233517, 'previous_gdhs': 263477, 'gdhs_change': -29960, 'gdhs_change_rate': -11.371011511441, 'average_hold_value': 505935.159294441, 'average_hold_amount': 21939.9461966366, 'total_market_value': 118144460592.96, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 3, 8), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 3, 31), 'change_range': -12.74934952, 'current_gdhs': 256985, 'previous_gdhs': 233517, 'gdhs_change': 23468, 'gdhs_change_rate': 10.049803654552, 'average_hold_value': 401119.950074596, 'average_hold_amount': 19936.3792283596, 'total_market_value': 103081810369.92, 'total_equity': 5123350416, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 6, 30), 'change_range': -20.0173227, 'current_gdhs': 281819, 'previous_gdhs': 256985, 'gdhs_change': 24834, 'gdhs_change_rate': 9.663599042746, 'average_hold_value': 290000.623911269, 'average_hold_amount': 29087.3243642196, 'total_market_value': 81727685830.05, 'total_equity': 8197360665, 'equity_change': 3074010249, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2013, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 9, 30), 'change_range': 19.15747242, 'current_gdhs': 291054, 'previous_gdhs': 281819, 'gdhs_change': 9235, 'gdhs_change_rate': 3.276925970215, 'average_hold_value': 334593.046995403, 'average_hold_amount': 28164.3978952359, 'total_market_value': 97384644700.2, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2013, 10, 23), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2013, 12, 31), 'change_range': 3.11447811, 'current_gdhs': 298070, 'previous_gdhs': 291054, 'gdhs_change': 7016, 'gdhs_change_rate': 2.410549245157, 'average_hold_value': 336892.904841983, 'average_hold_amount': 27501.4616197538, 'total_market_value': 100417668146.25, 'total_equity': 8197360665, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 2, 28), 'change_range': -9.14285714, 'current_gdhs': 310335, 'previous_gdhs': 298070, 'gdhs_change': 12265, 'gdhs_change_rate': 4.11480524709, 'average_hold_value': 341456.487831795, 'average_hold_amount': 30678.9297243302, 'total_market_value': 105965899151.28, 'total_equity': 9520745656, 'equity_change': 1323384991, 'equity_change_reason': '发行融资', 'announcement_date': datetime.date(2014, 3, 7), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 3, 31), 'change_range': -3.23450135, 'current_gdhs': 319109, 'previous_gdhs': 310335, 'gdhs_change': 8774, 'gdhs_change_rate': 2.827267307909, 'average_hold_value': 321327.291662473, 'average_hold_amount': 29835.4031255778, 'total_market_value': 102538430715.12, 'total_equity': 9520745656, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2014, 4, 24), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2014, 6, 30), 'change_range': 11.97681264, 'current_gdhs': 298305, 'previous_gdhs': 319109, 'gdhs_change': -20804, 'gdhs_change_rate': -6.519402461228, 'average_hold_value': 379546.797201421, 'average_hold_amount': 38299.3740869245, 'total_market_value': 113220707339.17, 'total_equity': 11424894787, 'equity_change': 1904149131, 'equity_change_reason': '分红派息', 'announcement_date': datetime.date(2014, 8, 14), 'stock_code': '000001', 'stock_name': '平安银行'}  ... displaying 10 of 63 total bound parameter sets ...  {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 3, 31), 'change_range': -2.34171726, 'current_gdhs': 504267, 'previous_gdhs': 479969, 'gdhs_change': 24298, 'gdhs_change_rate': 5.062410280664, 'average_hold_value': 433323.296804034, 'average_hold_amount': 38483.418899115, 'total_market_value': 218510638909.48, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 4, 19), 'stock_code': '000001', 'stock_name': '平安银行'}, {'symbol': 'SZ000001', 'end_date': datetime.date(2025, 6, 30), 'change_range': 10.55212125, 'current_gdhs': 443583, 'previous_gdhs': 504267, 'gdhs_change': -60684, 'gdhs_change_rate': -12.034100982218, 'average_hold_value': 528039.69640374, 'average_hold_amount': 43748.1107211052, 'total_market_value': 234229432649.86, 'total_equity': 19405918198, 'equity_change': 0, 'equity_change_reason': '', 'announcement_date': datetime.date(2025, 8, 23), 'stock_code': '000001', 'stock_name': '平安银行'}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

2025-09-09 10:54:32 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:25 - 股票代码已从 000001 格式化为 SZ000001
2025-09-09 10:54:32 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SZ000001] 获取到 63 条股东户数详情数据
2025-09-09 10:54:33 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:96 - [SZ000001] 成功同步 63 条股东户数详情数据
2025-09-09 10:54:40 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:25 - 股票代码已从 000001 格式化为 SZ000001
2025-09-09 10:54:41 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SZ000001] 获取到 63 条股东户数详情数据
2025-09-09 10:54:42 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:96 - [SZ000001] 成功同步 63 条股东户数详情数据
2025-09-09 10:58:03 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:25 - 股票代码已从 000001 格式化为 SZ000001
2025-09-09 10:58:03 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SZ000001] 获取到 63 条股东户数详情数据
2025-09-09 10:58:04 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:96 - [SZ000001] 成功同步 63 条股东户数详情数据
2025-09-09 10:59:56 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:25 - 股票代码已从 600004 格式化为 SH600004
2025-09-09 10:59:56 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:32 - [SH600004] 获取到 793 条主要股东数据
2025-09-09 10:59:57 | ERROR    | core.sync.sync_main_holder:sync_stock_main_holder:95 - [SH600004] 数据库操作失败: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'holder_explain' at row 701
[SQL: INSERT INTO stock_main_holder_data (symbol, number, holder_name, hold_amount, hold_ratio, stock_type, end_date, announcement_date, holder_explain, holder_total_num, average_hold_num) VALUES (%(symbol)s, %(number)s, %(holder_name)s, %(hold_amount)s, %(hold_ratio)s, %(stock_type)s, %(end_date)s, %(announcement_date)s, %(holder_explain)s, %(holder_total_num)s, %(average_hold_num)s)]
[parameters: [{'symbol': 'SH600004', 'number': '1', 'holder_name': '广东省机场管理集团有限公司', 'hold_amount': 1353744552.0, 'hold_ratio': 57.2, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '2', 'holder_name': '香港中央结算有限公司', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '3', 'holder_name': '信泰人寿保险股份有限公司－传统产品', 'hold_amount': 21765803.0, 'hold_ratio': 0.92, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '4', 'holder_name': '中汇人寿保险股份有限公司－传统产品', 'hold_amount': 0.0, 'hold_ratio': 0.77, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '5', 'holder_name': '中国农业银行股份有限公司－中证500交易型开放式指数证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '6', 'holder_name': '上海浦东发展银行股份有限公司－易方达裕祥回报债券型证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '7', 'holder_name': '招商银行股份有限公司－工银瑞信红利优享灵活配置混合型证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '8', 'holder_name': '全国社保基金一零一组合', 'hold_amount': 9402733.0, 'hold_ratio': 0.4, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}  ... displaying 10 of 793 total bound parameter sets ...  {'symbol': 'SH600004', 'number': '4', 'holder_name': '中国民航机场建设总公司', 'hold_amount': 6000000.0, 'hold_ratio': 1.0, 'stock_type': '国有法人股', 'end_date': datetime.date(2003, 4, 14), 'announcement_date': '', 'holder_explain': '', 'holder_total_num': 0.0, 'average_hold_num': 0.0}, {'symbol': 'SH600004', 'number': '5', 'holder_name': '中国国际航空公司', 'hold_amount': 6000000.0, 'hold_ratio': 1.0, 'stock_type': '国有法人股', 'end_date': datetime.date(2003, 4, 14), 'announcement_date': '', 'holder_explain': '', 'holder_total_num': 0.0, 'average_hold_num': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-09 10:59:57 | ERROR    | core.sync.sync_main_holder:sync_stock_main_holder:103 - [SH600004] 获取主要股东数据失败: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'holder_explain' at row 701
[SQL: INSERT INTO stock_main_holder_data (symbol, number, holder_name, hold_amount, hold_ratio, stock_type, end_date, announcement_date, holder_explain, holder_total_num, average_hold_num) VALUES (%(symbol)s, %(number)s, %(holder_name)s, %(hold_amount)s, %(hold_ratio)s, %(stock_type)s, %(end_date)s, %(announcement_date)s, %(holder_explain)s, %(holder_total_num)s, %(average_hold_num)s)]
[parameters: [{'symbol': 'SH600004', 'number': '1', 'holder_name': '广东省机场管理集团有限公司', 'hold_amount': 1353744552.0, 'hold_ratio': 57.2, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '2', 'holder_name': '香港中央结算有限公司', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '3', 'holder_name': '信泰人寿保险股份有限公司－传统产品', 'hold_amount': 21765803.0, 'hold_ratio': 0.92, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '4', 'holder_name': '中汇人寿保险股份有限公司－传统产品', 'hold_amount': 0.0, 'hold_ratio': 0.77, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '5', 'holder_name': '中国农业银行股份有限公司－中证500交易型开放式指数证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '6', 'holder_name': '上海浦东发展银行股份有限公司－易方达裕祥回报债券型证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '7', 'holder_name': '招商银行股份有限公司－工银瑞信红利优享灵活配置混合型证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '8', 'holder_name': '全国社保基金一零一组合', 'hold_amount': 9402733.0, 'hold_ratio': 0.4, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}  ... displaying 10 of 793 total bound parameter sets ...  {'symbol': 'SH600004', 'number': '4', 'holder_name': '中国民航机场建设总公司', 'hold_amount': 6000000.0, 'hold_ratio': 1.0, 'stock_type': '国有法人股', 'end_date': datetime.date(2003, 4, 14), 'announcement_date': '', 'holder_explain': '', 'holder_total_num': 0.0, 'average_hold_num': 0.0}, {'symbol': 'SH600004', 'number': '5', 'holder_name': '中国国际航空公司', 'hold_amount': 6000000.0, 'hold_ratio': 1.0, 'stock_type': '国有法人股', 'end_date': datetime.date(2003, 4, 14), 'announcement_date': '', 'holder_explain': '', 'holder_total_num': 0.0, 'average_hold_num': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-09-09 10:59:57 | ERROR    | core.sync.sync_main_holder:sync_stock_main_holder:104 - [SH600004] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Data too long for column 'holder_explain' at row 701

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.DataError: 1406 (22001): Data too long for column 'holder_explain' at row 701

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_main_holder.py", line 89, in sync_stock_main_holder
    db.bulk_insert_mappings(StockMainHolderDB, main_holder_records)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4661, in bulk_insert_mappings
    self._bulk_save_mappings(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4756, in _bulk_save_mappings
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4744, in _bulk_save_mappings
    bulk_persistence._bulk_insert(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 222, in _bulk_insert
    result = persistence._emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.DataError: (mysql.connector.errors.DataError) 1406 (22001): Data too long for column 'holder_explain' at row 701
[SQL: INSERT INTO stock_main_holder_data (symbol, number, holder_name, hold_amount, hold_ratio, stock_type, end_date, announcement_date, holder_explain, holder_total_num, average_hold_num) VALUES (%(symbol)s, %(number)s, %(holder_name)s, %(hold_amount)s, %(hold_ratio)s, %(stock_type)s, %(end_date)s, %(announcement_date)s, %(holder_explain)s, %(holder_total_num)s, %(average_hold_num)s)]
[parameters: [{'symbol': 'SH600004', 'number': '1', 'holder_name': '广东省机场管理集团有限公司', 'hold_amount': 1353744552.0, 'hold_ratio': 57.2, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '2', 'holder_name': '香港中央结算有限公司', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '3', 'holder_name': '信泰人寿保险股份有限公司－传统产品', 'hold_amount': 21765803.0, 'hold_ratio': 0.92, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '4', 'holder_name': '中汇人寿保险股份有限公司－传统产品', 'hold_amount': 0.0, 'hold_ratio': 0.77, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '5', 'holder_name': '中国农业银行股份有限公司－中证500交易型开放式指数证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '6', 'holder_name': '上海浦东发展银行股份有限公司－易方达裕祥回报债券型证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '7', 'holder_name': '招商银行股份有限公司－工银瑞信红利优享灵活配置混合型证券投资基金', 'hold_amount': 0.0, 'hold_ratio': 0.0, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}, {'symbol': 'SH600004', 'number': '8', 'holder_name': '全国社保基金一零一组合', 'hold_amount': 9402733.0, 'hold_ratio': 0.4, 'stock_type': '流通A股', 'end_date': datetime.date(2025, 6, 30), 'announcement_date': datetime.date(2025, 8, 21), 'holder_explain': '', 'holder_total_num': 81878.0, 'average_hold_num': 28905.0}  ... displaying 10 of 793 total bound parameter sets ...  {'symbol': 'SH600004', 'number': '4', 'holder_name': '中国民航机场建设总公司', 'hold_amount': 6000000.0, 'hold_ratio': 1.0, 'stock_type': '国有法人股', 'end_date': datetime.date(2003, 4, 14), 'announcement_date': '', 'holder_explain': '', 'holder_total_num': 0.0, 'average_hold_num': 0.0}, {'symbol': 'SH600004', 'number': '5', 'holder_name': '中国国际航空公司', 'hold_amount': 6000000.0, 'hold_ratio': 1.0, 'stock_type': '国有法人股', 'end_date': datetime.date(2003, 4, 14), 'announcement_date': '', 'holder_explain': '', 'holder_total_num': 0.0, 'average_hold_num': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/9h9h)

2025-09-09 11:00:27 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:25 - 股票代码已从 600004 格式化为 SH600004
2025-09-09 11:00:27 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:32 - [SH600004] 获取到 793 条主要股东数据
2025-09-09 11:00:28 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:91 - [SH600004] 成功同步 793 条主要股东数据
2025-09-09 11:01:03 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:25 - 股票代码已从 600004 格式化为 SH600004
2025-09-09 11:01:04 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:32 - [SH600004] 获取到 793 条主要股东数据
2025-09-09 11:01:05 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:91 - [SH600004] 成功同步 793 条主要股东数据
2025-09-09 11:06:27 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:18 - Fetched 5748 stock records from API
2025-09-09 11:06:28 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:75 - Deleted all existing stock spot data
2025-09-09 11:06:29 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 1, records: 1000
2025-09-09 11:06:29 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 2, records: 1000
2025-09-09 11:06:30 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 3, records: 1000
2025-09-09 11:06:31 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 4, records: 1000
2025-09-09 11:06:32 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 5, records: 1000
2025-09-09 11:06:33 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 6, records: 748
2025-09-09 11:06:33 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:91 - Successfully synced 5748 stock records
2025-09-09 11:06:34 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [SH600004] 未获取到 20240909 至 20250909 的历史数据
2025-09-09 11:06:35 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH600004] 获取到 200 条主营构成数据
2025-09-09 11:06:35 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:139 - [SH600004] 成功同步 200 条主营构成数据
2025-09-09 11:06:38 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:33 - [SH600004] 获取到 93 条资产负债表数据
2025-09-09 11:06:40 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:71 - [SH600004] 成功同步 6696 条资产负债表数据
2025-09-09 11:06:42 | INFO     | core.sync.sync_research_report:sync_stock_research_report:32 - [SH600004] 获取到 74 条个股研报数据
2025-09-09 11:06:43 | INFO     | core.sync.sync_research_report:sync_stock_research_report:97 - [SH600004] 成功同步 74 条个股研报数据
2025-09-09 11:06:44 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:33 - [SH600004] 获取到 94 条关键指标数据
2025-09-09 11:06:45 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:93 - [SH600004] 成功同步 94 条关键指标数据
2025-09-09 11:06:52 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:39 - [SH600004] 获取到 42 条财务指标数据
2025-09-09 11:06:53 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:174 - [SH600004] 成功同步 42 条财务指标数据
2025-09-09 11:06:54 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SH600004] 获取到 54 条股东户数详情数据
2025-09-09 11:06:55 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:96 - [SH600004] 成功同步 54 条股东户数详情数据
2025-09-09 11:06:56 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:32 - [SH600004] 获取到 793 条主要股东数据
2025-09-09 11:06:57 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:91 - [SH600004] 成功同步 793 条主要股东数据
2025-09-09 11:09:19 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 1 批数据，记录数: 500
2025-09-09 11:09:19 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 2 批数据，记录数: 500
2025-09-09 11:09:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 3 批数据，记录数: 500
2025-09-09 11:09:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 4 批数据，记录数: 500
2025-09-09 11:09:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 5 批数据，记录数: 500
2025-09-09 11:09:21 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 6 批数据，记录数: 500
2025-09-09 11:09:21 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 7 批数据，记录数: 500
2025-09-09 11:09:22 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 8 批数据，记录数: 500
2025-09-09 11:09:22 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 9 批数据，记录数: 500
2025-09-09 11:09:22 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 10 批数据，记录数: 500
2025-09-09 11:09:23 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 11 批数据，记录数: 385
2025-09-09 11:09:23 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:141 - [600004] 成功同步 5385 条历史数据
2025-09-09 11:09:55 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:18 - Fetched 5748 stock records from API
2025-09-09 11:09:55 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:75 - Deleted all existing stock spot data
2025-09-09 11:09:56 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 1, records: 1000
2025-09-09 11:09:57 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 2, records: 1000
2025-09-09 11:09:58 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 3, records: 1000
2025-09-09 11:09:58 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 4, records: 1000
2025-09-09 11:09:59 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 5, records: 1000
2025-09-09 11:10:00 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 6, records: 748
2025-09-09 11:10:00 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:91 - Successfully synced 5748 stock records
2025-09-09 11:10:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:137 - [600004] 批量插入第 1 批数据，记录数: 243
2025-09-09 11:10:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:141 - [600004] 成功同步 243 条历史数据
2025-09-09 11:10:01 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH600004] 获取到 200 条主营构成数据
2025-09-09 11:10:02 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:145 - [SH600004] 数据库操作失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '600004-2025-06-30-按产品分类-航空服务' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '航空服务', 'main_income': 3021203473.93, 'income_ratio': 0.810834, 'main_cost': 2245031524.75, 'cost_ratio': 0.846857, 'main_profit': 776171949.18, 'profit_ratio': 0.722001, 'gross_margin': 0.256908}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '地勤服务', 'main_income': 320612872.08, 'income_ratio': 0.086046, 'main_cost': 239634500.62, 'cost_ratio': 0.090393, 'main_profit': 80978371.46, 'profit_ratio': 0.075327, 'gross_margin': 0.252574}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '贵宾服务', 'main_income': 226527219.91, 'income_ratio': 0.060796, 'main_cost': 149926300.2, 'cost_ratio': 0.056554, 'main_profit': 76600919.71, 'profit_ratio': 0.071255, 'gross_margin': 0.338153}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '广告业务', 'main_income': 195912217.03, 'income_ratio': 0.052579, 'main_cost': 114910103.18, 'cost_ratio': 0.043346, 'main_profit': 81002113.85, 'profit_ratio': 0.075349, 'gross_margin': 0.413461}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '设备维护', 'main_income': 133789212.34, 'income_ratio': 0.035906, 'main_cost': 112769934.88, 'cost_ratio': 0.042538, 'main_profit': 21019277.46, 'profit_ratio': 0.019552, 'gross_margin': 0.157107}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '配餐服务', 'main_income': 119894566.73, 'income_ratio': 0.032177, 'main_cost': 92691258.4, 'cost_ratio': 0.034964, 'main_profit': 27203308.33, 'profit_ratio': 0.025305, 'gross_margin': 0.226894}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '信息技术', 'main_income': 103933289.37, 'income_ratio': 0.027894, 'main_cost': 58335512.45, 'cost_ratio': 0.022005, 'main_profit': 45597776.92, 'profit_ratio': 0.042415, 'gross_margin': 0.438722}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '地面运输服务', 'main_income': 84463044.72, 'income_ratio': 0.022668, 'main_cost': 89222711.19, 'cost_ratio': 0.033656, 'main_profit': -4759666.47, 'profit_ratio': -0.004427, 'gross_margin': -0.056352}  ... displaying 10 of 200 total bound parameter sets ...  {'symbol': '600004', 'report_date': datetime.date(2016, 6, 30), 'category_type': '按地区分类', 'main_composition': '广州', 'main_income': 2984650287.66, 'income_ratio': 1.0, 'main_cost': 1815901788.3, 'cost_ratio': 1.0, 'main_profit': 1168748499.36, 'profit_ratio': 1.0, 'gross_margin': 0.391586}, {'symbol': '600004', 'report_date': datetime.date(2015, 12, 31), 'category_type': '', 'main_composition': '航空运输业', 'main_income': 4888452052.2, 'income_ratio': 1.0, 'main_cost': 2846807484.67, 'cost_ratio': 1.0, 'main_profit': 2041644567.53, 'profit_ratio': 1.0, 'gross_margin': 0.417646}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-09 11:10:02 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:146 - [SH600004] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '600004-2025-06-30-按产品分类-航空服务' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '600004-2025-06-30-按产品分类-航空服务' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 138, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '600004-2025-06-30-按产品分类-航空服务' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '航空服务', 'main_income': 3021203473.93, 'income_ratio': 0.810834, 'main_cost': 2245031524.75, 'cost_ratio': 0.846857, 'main_profit': 776171949.18, 'profit_ratio': 0.722001, 'gross_margin': 0.256908}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '地勤服务', 'main_income': 320612872.08, 'income_ratio': 0.086046, 'main_cost': 239634500.62, 'cost_ratio': 0.090393, 'main_profit': 80978371.46, 'profit_ratio': 0.075327, 'gross_margin': 0.252574}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '贵宾服务', 'main_income': 226527219.91, 'income_ratio': 0.060796, 'main_cost': 149926300.2, 'cost_ratio': 0.056554, 'main_profit': 76600919.71, 'profit_ratio': 0.071255, 'gross_margin': 0.338153}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '广告业务', 'main_income': 195912217.03, 'income_ratio': 0.052579, 'main_cost': 114910103.18, 'cost_ratio': 0.043346, 'main_profit': 81002113.85, 'profit_ratio': 0.075349, 'gross_margin': 0.413461}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '设备维护', 'main_income': 133789212.34, 'income_ratio': 0.035906, 'main_cost': 112769934.88, 'cost_ratio': 0.042538, 'main_profit': 21019277.46, 'profit_ratio': 0.019552, 'gross_margin': 0.157107}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '配餐服务', 'main_income': 119894566.73, 'income_ratio': 0.032177, 'main_cost': 92691258.4, 'cost_ratio': 0.034964, 'main_profit': 27203308.33, 'profit_ratio': 0.025305, 'gross_margin': 0.226894}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '信息技术', 'main_income': 103933289.37, 'income_ratio': 0.027894, 'main_cost': 58335512.45, 'cost_ratio': 0.022005, 'main_profit': 45597776.92, 'profit_ratio': 0.042415, 'gross_margin': 0.438722}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '地面运输服务', 'main_income': 84463044.72, 'income_ratio': 0.022668, 'main_cost': 89222711.19, 'cost_ratio': 0.033656, 'main_profit': -4759666.47, 'profit_ratio': -0.004427, 'gross_margin': -0.056352}  ... displaying 10 of 200 total bound parameter sets ...  {'symbol': '600004', 'report_date': datetime.date(2016, 6, 30), 'category_type': '按地区分类', 'main_composition': '广州', 'main_income': 2984650287.66, 'income_ratio': 1.0, 'main_cost': 1815901788.3, 'cost_ratio': 1.0, 'main_profit': 1168748499.36, 'profit_ratio': 1.0, 'gross_margin': 0.391586}, {'symbol': '600004', 'report_date': datetime.date(2015, 12, 31), 'category_type': '', 'main_composition': '航空运输业', 'main_income': 4888452052.2, 'income_ratio': 1.0, 'main_cost': 2846807484.67, 'cost_ratio': 1.0, 'main_profit': 2041644567.53, 'profit_ratio': 1.0, 'gross_margin': 0.417646}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-09 11:10:02 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:154 - [SH600004] 获取主营构成数据失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '600004-2025-06-30-按产品分类-航空服务' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '航空服务', 'main_income': 3021203473.93, 'income_ratio': 0.810834, 'main_cost': 2245031524.75, 'cost_ratio': 0.846857, 'main_profit': 776171949.18, 'profit_ratio': 0.722001, 'gross_margin': 0.256908}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '地勤服务', 'main_income': 320612872.08, 'income_ratio': 0.086046, 'main_cost': 239634500.62, 'cost_ratio': 0.090393, 'main_profit': 80978371.46, 'profit_ratio': 0.075327, 'gross_margin': 0.252574}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '贵宾服务', 'main_income': 226527219.91, 'income_ratio': 0.060796, 'main_cost': 149926300.2, 'cost_ratio': 0.056554, 'main_profit': 76600919.71, 'profit_ratio': 0.071255, 'gross_margin': 0.338153}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '广告业务', 'main_income': 195912217.03, 'income_ratio': 0.052579, 'main_cost': 114910103.18, 'cost_ratio': 0.043346, 'main_profit': 81002113.85, 'profit_ratio': 0.075349, 'gross_margin': 0.413461}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '设备维护', 'main_income': 133789212.34, 'income_ratio': 0.035906, 'main_cost': 112769934.88, 'cost_ratio': 0.042538, 'main_profit': 21019277.46, 'profit_ratio': 0.019552, 'gross_margin': 0.157107}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '配餐服务', 'main_income': 119894566.73, 'income_ratio': 0.032177, 'main_cost': 92691258.4, 'cost_ratio': 0.034964, 'main_profit': 27203308.33, 'profit_ratio': 0.025305, 'gross_margin': 0.226894}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '信息技术', 'main_income': 103933289.37, 'income_ratio': 0.027894, 'main_cost': 58335512.45, 'cost_ratio': 0.022005, 'main_profit': 45597776.92, 'profit_ratio': 0.042415, 'gross_margin': 0.438722}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '地面运输服务', 'main_income': 84463044.72, 'income_ratio': 0.022668, 'main_cost': 89222711.19, 'cost_ratio': 0.033656, 'main_profit': -4759666.47, 'profit_ratio': -0.004427, 'gross_margin': -0.056352}  ... displaying 10 of 200 total bound parameter sets ...  {'symbol': '600004', 'report_date': datetime.date(2016, 6, 30), 'category_type': '按地区分类', 'main_composition': '广州', 'main_income': 2984650287.66, 'income_ratio': 1.0, 'main_cost': 1815901788.3, 'cost_ratio': 1.0, 'main_profit': 1168748499.36, 'profit_ratio': 1.0, 'gross_margin': 0.391586}, {'symbol': '600004', 'report_date': datetime.date(2015, 12, 31), 'category_type': '', 'main_composition': '航空运输业', 'main_income': 4888452052.2, 'income_ratio': 1.0, 'main_cost': 2846807484.67, 'cost_ratio': 1.0, 'main_profit': 2041644567.53, 'profit_ratio': 1.0, 'gross_margin': 0.417646}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-09 11:10:02 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:155 - [SH600004] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '600004-2025-06-30-按产品分类-航空服务' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '600004-2025-06-30-按产品分类-航空服务' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 138, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '600004-2025-06-30-按产品分类-航空服务' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '航空服务', 'main_income': 3021203473.93, 'income_ratio': 0.810834, 'main_cost': 2245031524.75, 'cost_ratio': 0.846857, 'main_profit': 776171949.18, 'profit_ratio': 0.722001, 'gross_margin': 0.256908}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '地勤服务', 'main_income': 320612872.08, 'income_ratio': 0.086046, 'main_cost': 239634500.62, 'cost_ratio': 0.090393, 'main_profit': 80978371.46, 'profit_ratio': 0.075327, 'gross_margin': 0.252574}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '贵宾服务', 'main_income': 226527219.91, 'income_ratio': 0.060796, 'main_cost': 149926300.2, 'cost_ratio': 0.056554, 'main_profit': 76600919.71, 'profit_ratio': 0.071255, 'gross_margin': 0.338153}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '广告业务', 'main_income': 195912217.03, 'income_ratio': 0.052579, 'main_cost': 114910103.18, 'cost_ratio': 0.043346, 'main_profit': 81002113.85, 'profit_ratio': 0.075349, 'gross_margin': 0.413461}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '设备维护', 'main_income': 133789212.34, 'income_ratio': 0.035906, 'main_cost': 112769934.88, 'cost_ratio': 0.042538, 'main_profit': 21019277.46, 'profit_ratio': 0.019552, 'gross_margin': 0.157107}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '配餐服务', 'main_income': 119894566.73, 'income_ratio': 0.032177, 'main_cost': 92691258.4, 'cost_ratio': 0.034964, 'main_profit': 27203308.33, 'profit_ratio': 0.025305, 'gross_margin': 0.226894}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '信息技术', 'main_income': 103933289.37, 'income_ratio': 0.027894, 'main_cost': 58335512.45, 'cost_ratio': 0.022005, 'main_profit': 45597776.92, 'profit_ratio': 0.042415, 'gross_margin': 0.438722}, {'symbol': '600004', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '地面运输服务', 'main_income': 84463044.72, 'income_ratio': 0.022668, 'main_cost': 89222711.19, 'cost_ratio': 0.033656, 'main_profit': -4759666.47, 'profit_ratio': -0.004427, 'gross_margin': -0.056352}  ... displaying 10 of 200 total bound parameter sets ...  {'symbol': '600004', 'report_date': datetime.date(2016, 6, 30), 'category_type': '按地区分类', 'main_composition': '广州', 'main_income': 2984650287.66, 'income_ratio': 1.0, 'main_cost': 1815901788.3, 'cost_ratio': 1.0, 'main_profit': 1168748499.36, 'profit_ratio': 1.0, 'gross_margin': 0.391586}, {'symbol': '600004', 'report_date': datetime.date(2015, 12, 31), 'category_type': '', 'main_composition': '航空运输业', 'main_income': 4888452052.2, 'income_ratio': 1.0, 'main_cost': 2846807484.67, 'cost_ratio': 1.0, 'main_profit': 2041644567.53, 'profit_ratio': 1.0, 'gross_margin': 0.417646}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-09 11:10:03 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:33 - [SH600004] 获取到 93 条资产负债表数据
2025-09-09 11:10:04 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:71 - [SH600004] 成功同步 6696 条资产负债表数据
2025-09-09 11:10:04 | INFO     | core.sync.sync_research_report:sync_stock_research_report:32 - [SH600004] 获取到 74 条个股研报数据
2025-09-09 11:10:05 | INFO     | core.sync.sync_research_report:sync_stock_research_report:97 - [SH600004] 成功同步 74 条个股研报数据
2025-09-09 11:10:06 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:33 - [SH600004] 获取到 94 条关键指标数据
2025-09-09 11:10:07 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:93 - [SH600004] 成功同步 94 条关键指标数据
2025-09-09 11:10:11 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:39 - [SH600004] 获取到 42 条财务指标数据
2025-09-09 11:10:12 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:174 - [SH600004] 成功同步 42 条财务指标数据
2025-09-09 11:10:12 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SH600004] 获取到 54 条股东户数详情数据
2025-09-09 11:10:13 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:96 - [SH600004] 成功同步 54 条股东户数详情数据
2025-09-09 11:10:14 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:32 - [SH600004] 获取到 793 条主要股东数据
2025-09-09 11:10:14 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:91 - [SH600004] 成功同步 793 条主要股东数据
2025-09-09 11:13:01 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:18 - Fetched 5748 stock records from API
2025-09-09 11:13:02 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:75 - Deleted all existing stock spot data
2025-09-09 11:13:02 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 1, records: 1000
2025-09-09 11:13:03 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 2, records: 1000
2025-09-09 11:13:04 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 3, records: 1000
2025-09-09 11:13:04 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 4, records: 1000
2025-09-09 11:13:05 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 5, records: 1000
2025-09-09 11:13:06 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:89 - Committed batch 6, records: 748
2025-09-09 11:13:06 | INFO     | core.sync.sync_spot:sync_stock_zh_a_spot_em:91 - Successfully synced 5748 stock records
2025-09-09 11:13:06 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:53 - [600004] 最新数据日期 2025-09-09 已超过或等于结束日期 2025-09-09，跳过同步
2025-09-09 11:13:06 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH600004] 获取到 200 条主营构成数据
2025-09-09 11:13:34 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:139 - [SH600004] 成功同步 200 条主营构成数据
2025-09-09 11:13:35 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:33 - [SH600004] 获取到 93 条资产负债表数据
2025-09-09 11:13:36 | INFO     | core.sync.sync_financial_debt:sync_stock_financial_debt:71 - [SH600004] 成功同步 6696 条资产负债表数据
2025-09-09 11:13:37 | INFO     | core.sync.sync_research_report:sync_stock_research_report:32 - [SH600004] 获取到 74 条个股研报数据
2025-09-09 11:13:37 | INFO     | core.sync.sync_research_report:sync_stock_research_report:97 - [SH600004] 成功同步 74 条个股研报数据
2025-09-09 11:13:39 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:33 - [SH600004] 获取到 94 条关键指标数据
2025-09-09 11:13:39 | INFO     | core.sync.sync_financial_abstract:sync_stock_financial_abstract:93 - [SH600004] 成功同步 94 条关键指标数据
2025-09-09 11:13:43 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:39 - [SH600004] 获取到 42 条财务指标数据
2025-09-09 11:13:44 | INFO     | core.sync.sync_financial_analysis:sync_stock_financial_analysis:174 - [SH600004] 成功同步 42 条财务指标数据
2025-09-09 11:13:44 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:32 - [SH600004] 获取到 54 条股东户数详情数据
2025-09-09 11:13:45 | INFO     | core.sync.sync_gdhs:sync_stock_gdhs:96 - [SH600004] 成功同步 54 条股东户数详情数据
2025-09-09 11:13:45 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:32 - [SH600004] 获取到 793 条主要股东数据
2025-09-09 11:13:46 | INFO     | core.sync.sync_main_holder:sync_stock_main_holder:91 - [SH600004] 成功同步 793 条主要股东数据
2025-09-09 14:43:58 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH600004] 获取到 200 条主营构成数据
2025-09-09 14:43:59 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:139 - [SH600004] 批量插入第 1 批数据，记录数: 200
2025-09-09 14:43:59 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:143 - [SH600004] 成功同步 200 条主营构成数据
2025-09-09 20:40:52 | INFO     | trading_grid.evaluator.evaluator:run:15 - 正在评估因子 volatility...
2025-09-09 20:40:52 | INFO     | trading_grid.evaluator.evaluator:run:15 - 正在评估因子 pe_ratio...
2025-09-09 20:40:52 | INFO     | trading_grid.evaluator.evaluator:run:15 - 正在评估因子 liquidity...
2025-09-09 20:41:48 | INFO     | trading_grid.evaluator.evaluator:run:13 - 开始评估股票 000967 的因子
2025-09-09 20:41:48 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 volatility...
2025-09-09 20:41:48 | WARNING  | trading_grid.evaluator.evaluator:run:19 - 因子 volatility 未注册，跳过评估
2025-09-09 20:41:48 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 pe_ratio...
2025-09-09 20:41:48 | WARNING  | trading_grid.evaluator.evaluator:run:19 - 因子 pe_ratio 未注册，跳过评估
2025-09-09 20:41:49 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 liquidity...
2025-09-09 20:41:49 | WARNING  | trading_grid.evaluator.evaluator:run:19 - 因子 liquidity 未注册，跳过评估
2025-09-09 20:41:49 | INFO     | trading_grid.evaluator.evaluator:run:37 - 股票 000967 的因子评估完成，共评估 3 个因子
2025-09-09 20:43:32 | INFO     | trading_grid.evaluator.evaluator:run:13 - 开始评估股票 000967 的因子
2025-09-09 20:43:32 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 volatility...
2025-09-09 20:43:32 | WARNING  | trading_grid.evaluator.evaluator:run:19 - 因子 volatility 未注册，跳过评估
2025-09-09 20:43:32 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 pe_ratio...
2025-09-09 20:43:32 | WARNING  | trading_grid.evaluator.evaluator:run:19 - 因子 pe_ratio 未注册，跳过评估
2025-09-09 20:43:32 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 liquidity...
2025-09-09 20:43:32 | WARNING  | trading_grid.evaluator.evaluator:run:19 - 因子 liquidity 未注册，跳过评估
2025-09-09 20:43:32 | INFO     | trading_grid.evaluator.evaluator:run:37 - 股票 000967 的因子评估完成，共评估 3 个因子
2025-09-09 20:45:33 | INFO     | trading_grid.evaluator.evaluator:run:13 - 开始评估股票 000967 的因子
2025-09-09 20:45:33 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 volatility...
2025-09-09 20:47:48 | INFO     | trading_grid.evaluator.evaluator:run:13 - 开始评估股票 000967 的因子
2025-09-09 20:47:48 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 volatility...
2025-09-09 20:47:48 | INFO     | trading_grid.evaluator.evaluator:run:35 - 因子 volatility 评估完成，结果: {'factor': 'volatility', 'name': '波动率', 'value': 0.159, 'threshold': '0.05 - 0.50', 'conclusion': '适中，适合网格', 'is_passed': np.True_}
2025-09-09 20:47:48 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 pe_ratio...
2025-09-09 20:47:48 | INFO     | trading_grid.evaluator.evaluator:run:35 - 因子 pe_ratio 评估完成，结果: {'factor': 'pe_ratio', 'name': '市盈率', 'value': 25.0, 'threshold': '< 50', 'conclusion': '估值合理', 'is_passed': True}
2025-09-09 20:47:48 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 liquidity...
2025-09-09 20:47:48 | WARNING  | trading_grid.evaluator.evaluator:run:19 - 因子 liquidity 未注册，跳过评估
2025-09-09 20:47:48 | INFO     | trading_grid.evaluator.evaluator:run:37 - 股票 000967 的因子评估完成，共评估 3 个因子
2025-09-09 20:49:07 | INFO     | trading_grid.evaluator.evaluator:run:13 - 开始评估股票 000967 的因子
2025-09-09 20:49:07 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 volatility...
2025-09-09 20:49:07 | INFO     | trading_grid.evaluator.evaluator:run:35 - 因子 volatility 评估完成，结果: {'factor': 'volatility', 'name': '波动率', 'value': 0.159, 'threshold': '0.05 - 0.50', 'conclusion': '适中，适合网格', 'is_passed': True}
2025-09-09 20:49:07 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 pe_ratio...
2025-09-09 20:49:07 | INFO     | trading_grid.evaluator.evaluator:run:35 - 因子 pe_ratio 评估完成，结果: {'factor': 'pe_ratio', 'name': '市盈率', 'value': 25.0, 'threshold': '< 50', 'conclusion': '估值合理', 'is_passed': True}
2025-09-09 20:49:07 | INFO     | trading_grid.evaluator.evaluator:run:16 - 正在评估因子 liquidity...
2025-09-09 20:49:07 | WARNING  | trading_grid.evaluator.evaluator:run:19 - 因子 liquidity 未注册，跳过评估
2025-09-09 20:49:07 | INFO     | trading_grid.evaluator.evaluator:run:37 - 股票 000967 的因子评估完成，共评估 3 个因子
