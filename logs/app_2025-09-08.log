2025-09-08 16:43:34 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:25 - 开始同步历史数据，结束日期: 2025-09-08, 复权: hfq, 并发: 5
2025-09-08 16:43:35 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:41 - 股票代码: 5746, 已有任务: 0
2025-09-08 16:43:36 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:58 - 新增任务: 5746
2025-09-08 16:43:36 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:85 - 待处理任务: 500
2025-09-08 16:43:36 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000001] 开始同步
2025-09-08 16:43:36 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000002] 开始同步
2025-09-08 16:43:36 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000003] 开始同步
2025-09-08 16:43:36 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000004] 开始同步
2025-09-08 16:43:36 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000005] 开始同步
2025-09-08 16:43:36 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000001] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:37 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000005] 使用数据库最新日期后一天作为开始日期: 20240306
2025-09-08 16:43:37 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000003] 使用数据库最新日期后一天作为开始日期: 20020427
2025-09-08 16:43:37 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000002] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:37 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000004] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:37 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000003] 未获取到 20020427 至 20250908 的历史数据
2025-09-08 16:43:37 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000003] 完成，耗时: 1.10s，记录: 0
2025-09-08 16:43:37 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000005] 未获取到 20240306 至 20250908 的历史数据
2025-09-08 16:43:37 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000005] 完成，耗时: 1.10s，记录: 0
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000001] 批量插入 1 条新记录
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000001] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000001] 完成，耗时: 1.82s，记录: 1
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000002] 批量插入 1 条新记录
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000002] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000002] 完成，耗时: 2.10s，记录: 1
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000004] 批量插入 1 条新记录
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000004] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:38 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000004] 完成，耗时: 2.16s，记录: 1
2025-09-08 16:43:39 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000006] 开始同步
2025-09-08 16:43:39 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000007] 开始同步
2025-09-08 16:43:39 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000006] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:40 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000007] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:40 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000008] 开始同步
2025-09-08 16:43:40 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 1/500 (0.2%) | 成功:1 失败:0 | 耗时:4s 剩余:1852s
2025-09-08 16:43:40 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000008] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:40 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000009] 开始同步
2025-09-08 16:43:40 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 2/500 (0.4%) | 成功:2 失败:0 | 耗时:4s 剩余:1033s
2025-09-08 16:43:40 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000010] 开始同步
2025-09-08 16:43:40 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000009] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000010] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 3/500 (0.6%) | 成功:3 失败:0 | 耗时:5s 剩余:762s
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000006] 批量插入 1 条新记录
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000006] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000006] 完成，耗时: 1.70s，记录: 1
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000007] 批量插入 1 条新记录
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000007] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000007] 完成，耗时: 1.66s，记录: 1
2025-09-08 16:43:41 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 4/500 (0.8%) | 成功:4 失败:0 | 耗时:5s 剩余:658s
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000009] 批量插入 1 条新记录
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000009] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000009] 完成，耗时: 1.63s，记录: 1
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000008] 批量插入 1 条新记录
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000008] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000008] 完成，耗时: 2.01s，记录: 1
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 5/500 (1.0%) | 成功:5 失败:0 | 耗时:6s 剩余:590s
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000011] 开始同步
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000010] 批量插入 1 条新记录
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000010] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000010] 完成，耗时: 1.89s，记录: 1
2025-09-08 16:43:42 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000011] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:43 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 6/500 (1.2%) | 成功:6 失败:0 | 耗时:7s 剩余:541s
2025-09-08 16:43:43 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000012] 开始同步
2025-09-08 16:43:43 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000013] 开始同步
2025-09-08 16:43:43 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000012] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:43 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000013] 使用数据库最新日期后一天作为开始日期: 20040429
2025-09-08 16:43:43 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 7/500 (1.4%) | 成功:7 失败:0 | 耗时:7s 剩余:509s
2025-09-08 16:43:43 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000013] 未获取到 20040429 至 20250908 的历史数据
2025-09-08 16:43:43 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000013] 完成，耗时: 0.71s，记录: 0
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000011] 批量插入 1 条新记录
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000011] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000011] 完成，耗时: 1.52s，记录: 1
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 8/500 (1.6%) | 成功:8 失败:0 | 耗时:8s 剩余:470s
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000014] 开始同步
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000012] 批量插入 1 条新记录
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000014] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000012] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:44 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000012] 完成，耗时: 1.87s，记录: 1
2025-09-08 16:43:45 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000015] 开始同步
2025-09-08 16:43:45 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 9/500 (1.8%) | 成功:9 失败:0 | 耗时:9s 剩余:477s
2025-09-08 16:43:45 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000015] 使用数据库最新日期后一天作为开始日期: 20010609
2025-09-08 16:43:45 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 10/500 (2.0%) | 成功:10 失败:0 | 耗时:9s 剩余:458s
2025-09-08 16:43:45 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000015] 未获取到 20010609 至 20250908 的历史数据
2025-09-08 16:43:45 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000015] 完成，耗时: 0.83s，记录: 0
2025-09-08 16:43:45 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000016] 开始同步
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000017] 开始同步
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000016] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000014] 批量插入 1 条新记录
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000017] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000014] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000014] 完成，耗时: 1.66s，记录: 1
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 11/500 (2.2%) | 成功:11 失败:0 | 耗时:10s 剩余:445s
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000018] 开始同步
2025-09-08 16:43:46 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000018] 使用数据库最新日期后一天作为开始日期: 20200107
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 12/500 (2.4%) | 成功:12 失败:0 | 耗时:11s 剩余:432s
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000018] 未获取到 20200107 至 20250908 的历史数据
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000018] 完成，耗时: 0.66s，记录: 0
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000016] 批量插入 1 条新记录
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000016] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000016] 完成，耗时: 1.53s，记录: 1
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 13/500 (2.6%) | 成功:13 失败:0 | 耗时:11s 剩余:414s
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000017] 批量插入 1 条新记录
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000017] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000017] 完成，耗时: 1.44s，记录: 1
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000019] 开始同步
2025-09-08 16:43:47 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000020] 开始同步
2025-09-08 16:43:48 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000019] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:48 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000020] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:48 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 14/500 (2.8%) | 成功:14 失败:0 | 耗时:12s 剩余:411s
2025-09-08 16:43:48 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 15/500 (3.0%) | 成功:15 失败:0 | 耗时:12s 剩余:399s
2025-09-08 16:43:48 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000021] 开始同步
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000021] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000023] 开始同步
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000019] 批量插入 1 条新记录
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000019] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000019] 完成，耗时: 1.79s，记录: 1
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 16/500 (3.2%) | 成功:16 失败:0 | 耗时:13s 剩余:395s
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000020] 批量插入 1 条新记录
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000020] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000020] 完成，耗时: 1.73s，记录: 1
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000023] 使用数据库最新日期后一天作为开始日期: 20240725
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000024] 开始同步
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 17/500 (3.4%) | 成功:17 失败:0 | 耗时:13s 剩余:383s
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000023] 未获取到 20240725 至 20250908 的历史数据
2025-09-08 16:43:49 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000023] 完成，耗时: 0.61s，记录: 0
2025-09-08 16:43:50 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000024] 使用数据库最新日期后一天作为开始日期: 20151208
2025-09-08 16:43:50 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 18/500 (3.6%) | 成功:18 失败:0 | 耗时:14s 剩余:377s
2025-09-08 16:43:50 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000024] 未获取到 20151208 至 20250908 的历史数据
2025-09-08 16:43:50 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000024] 完成，耗时: 0.66s，记录: 0
2025-09-08 16:43:50 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000021] 批量插入 1 条新记录
2025-09-08 16:43:50 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000021] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:50 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000021] 完成，耗时: 1.63s，记录: 1
2025-09-08 16:43:51 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000025] 开始同步
2025-09-08 16:43:51 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000025] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:51 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000026] 开始同步
2025-09-08 16:43:51 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 19/500 (3.8%) | 成功:19 失败:0 | 耗时:15s 剩余:390s
2025-09-08 16:43:52 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000026] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:52 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000027] 开始同步
2025-09-08 16:43:52 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000028] 开始同步
2025-09-08 16:43:52 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000027] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:52 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000029] 开始同步
2025-09-08 16:43:52 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000028] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:52 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 20/500 (4.0%) | 成功:20 失败:0 | 耗时:16s 剩余:385s
2025-09-08 16:43:52 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000029] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000025] 批量插入 1 条新记录
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000025] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000025] 完成，耗时: 1.68s，记录: 1
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 21/500 (4.2%) | 成功:21 失败:0 | 耗时:17s 剩余:380s
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000026] 批量插入 1 条新记录
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000026] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000026] 完成，耗时: 1.60s，记录: 1
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 22/500 (4.4%) | 成功:22 失败:0 | 耗时:17s 剩余:373s
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000027] 批量插入 1 条新记录
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000027] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:53 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000027] 完成，耗时: 1.89s，记录: 1
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000029] 批量插入 1 条新记录
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000029] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000029] 完成，耗时: 1.69s，记录: 1
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000028] 批量插入 1 条新记录
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000028] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000028] 完成，耗时: 2.02s，记录: 1
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 23/500 (4.6%) | 成功:23 失败:0 | 耗时:18s 剩余:369s
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000030] 开始同步
2025-09-08 16:43:54 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000030] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:55 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 24/500 (4.8%) | 成功:24 失败:0 | 耗时:19s 剩余:370s
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000031] 开始同步
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000032] 开始同步
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000031] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000030] 批量插入 1 条新记录
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000030] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000030] 完成，耗时: 1.83s，记录: 1
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000033] 开始同步
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000034] 开始同步
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 25/500 (5.0%) | 成功:25 失败:0 | 耗时:20s 剩余:384s
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000032] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000033] 使用数据库最新日期后一天作为开始日期: 20170707
2025-09-08 16:43:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000034] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:57 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000033] 未获取到 20170707 至 20250908 的历史数据
2025-09-08 16:43:57 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000033] 完成，耗时: 0.87s，记录: 0
2025-09-08 16:43:57 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 26/500 (5.2%) | 成功:26 失败:0 | 耗时:21s 剩余:386s
2025-09-08 16:43:57 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000035] 开始同步
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000031] 批量插入 1 条新记录
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000031] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000031] 完成，耗时: 2.00s，记录: 1
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000035] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 27/500 (5.4%) | 成功:27 失败:0 | 耗时:22s 剩余:379s
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000032] 批量插入 1 条新记录
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000032] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000032] 完成，耗时: 1.83s，记录: 1
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000034] 批量插入 1 条新记录
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000034] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000034] 完成，耗时: 1.88s，记录: 1
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 28/500 (5.6%) | 成功:28 失败:0 | 耗时:22s 剩余:373s
2025-09-08 16:43:58 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000036] 开始同步
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000036] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 29/500 (5.8%) | 成功:29 失败:0 | 耗时:23s 剩余:370s
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000037] 开始同步
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000035] 批量插入 1 条新记录
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000035] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000035] 完成，耗时: 1.72s，记录: 1
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000037] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000038] 开始同步
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 30/500 (6.0%) | 成功:30 失败:0 | 耗时:23s 剩余:363s
2025-09-08 16:43:59 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000038] 使用数据库最新日期后一天作为开始日期: 20230712
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 31/500 (6.2%) | 成功:31 失败:0 | 耗时:24s 剩余:359s
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000038] 未获取到 20230712 至 20250908 的历史数据
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000038] 完成，耗时: 0.68s，记录: 0
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000039] 开始同步
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000036] 批量插入 1 条新记录
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000036] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000036] 完成，耗时: 1.66s，记录: 1
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000039] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 32/500 (6.4%) | 成功:32 失败:0 | 耗时:24s 剩余:353s
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000037] 批量插入 1 条新记录
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000037] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000037] 完成，耗时: 1.45s，记录: 1
2025-09-08 16:44:00 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000040] 开始同步
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000040] 使用数据库最新日期后一天作为开始日期: 20250401
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 33/500 (6.6%) | 成功:33 失败:0 | 耗时:25s 剩余:348s
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000040] 未获取到 20250401 至 20250908 的历史数据
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000040] 完成，耗时: 0.80s，记录: 0
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 34/500 (6.8%) | 成功:34 失败:0 | 耗时:25s 剩余:346s
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000042] 开始同步
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000039] 批量插入 1 条新记录
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000039] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:01 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000039] 完成，耗时: 1.50s，记录: 1
2025-09-08 16:44:02 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000042] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:02 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 35/500 (7.0%) | 成功:35 失败:0 | 耗时:26s 剩余:343s
2025-09-08 16:44:02 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000045] 开始同步
2025-09-08 16:44:02 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000045] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:02 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 36/500 (7.2%) | 成功:36 失败:0 | 耗时:26s 剩余:339s
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000046] 开始同步
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000042] 批量插入 1 条新记录
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000042] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000042] 完成，耗时: 1.53s，记录: 1
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000046] 使用数据库最新日期后一天作为开始日期: 20231228
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000047] 开始同步
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 37/500 (7.4%) | 成功:37 失败:0 | 耗时:27s 剩余:342s
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000046] 未获取到 20231228 至 20250908 的历史数据
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000046] 完成，耗时: 0.83s，记录: 0
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000047] 使用数据库最新日期后一天作为开始日期: 20020430
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000045] 批量插入 1 条新记录
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000045] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:03 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000045] 完成，耗时: 1.58s，记录: 1
2025-09-08 16:44:04 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 38/500 (7.6%) | 成功:38 失败:0 | 耗时:28s 剩余:337s
2025-09-08 16:44:04 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000047] 未获取到 20020430 至 20250908 的历史数据
2025-09-08 16:44:04 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000047] 完成，耗时: 0.58s，记录: 0
2025-09-08 16:44:04 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000048] 开始同步
2025-09-08 16:44:04 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000048] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:04 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 39/500 (7.8%) | 成功:39 失败:0 | 耗时:28s 剩余:336s
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000049] 开始同步
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000050] 开始同步
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000055] 开始同步
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000050] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000049] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000055] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000048] 批量插入 1 条新记录
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000048] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:05 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000048] 完成，耗时: 1.51s，记录: 1
2025-09-08 16:44:06 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 40/500 (8.0%) | 成功:40 失败:0 | 耗时:30s 剩余:340s
2025-09-08 16:44:06 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000056] 开始同步
2025-09-08 16:44:06 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 41/500 (8.2%) | 成功:41 失败:0 | 耗时:30s 剩余:336s
2025-09-08 16:44:06 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000056] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000050] 批量插入 1 条新记录
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000050] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000050] 完成，耗时: 1.70s，记录: 1
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000049] 批量插入 1 条新记录
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000049] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000049] 完成，耗时: 1.78s，记录: 1
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000055] 批量插入 1 条新记录
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000055] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000055] 完成，耗时: 1.63s，记录: 1
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 42/500 (8.4%) | 成功:42 失败:0 | 耗时:31s 剩余:336s
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000058] 开始同步
2025-09-08 16:44:07 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 43/500 (8.6%) | 成功:43 失败:0 | 耗时:31s 剩余:333s
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000056] 批量插入 1 条新记录
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000056] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000056] 完成，耗时: 1.71s，记录: 1
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000058] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000059] 开始同步
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 44/500 (8.8%) | 成功:44 失败:0 | 耗时:32s 剩余:330s
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000060] 开始同步
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000059] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000060] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:08 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 45/500 (9.0%) | 成功:45 失败:0 | 耗时:32s 剩余:328s
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000058] 批量插入 1 条新记录
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000058] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000058] 完成，耗时: 1.49s，记录: 1
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000061] 开始同步
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000062] 开始同步
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 46/500 (9.2%) | 成功:46 失败:0 | 耗时:33s 剩余:326s
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000062] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000061] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000059] 批量插入 1 条新记录
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000059] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:09 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000059] 完成，耗时: 1.50s，记录: 1
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 47/500 (9.4%) | 成功:47 失败:0 | 耗时:34s 剩余:324s
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000060] 批量插入 1 条新记录
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000060] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000060] 完成，耗时: 1.61s，记录: 1
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 48/500 (9.6%) | 成功:48 失败:0 | 耗时:34s 剩余:321s
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000061] 批量插入 1 条新记录
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000061] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000061] 完成，耗时: 1.51s，记录: 1
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000062] 批量插入 1 条新记录
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000062] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:10 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000062] 完成，耗时: 1.52s，记录: 1
2025-09-08 16:44:11 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000063] 开始同步
2025-09-08 16:44:11 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000065] 开始同步
2025-09-08 16:44:11 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000063] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:11 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000065] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:11 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 49/500 (9.8%) | 成功:49 失败:0 | 耗时:35s 剩余:325s
2025-09-08 16:44:12 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000066] 开始同步
2025-09-08 16:44:12 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000066] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:12 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000068] 开始同步
2025-09-08 16:44:12 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 50/500 (10.0%) | 成功:50 失败:0 | 耗时:36s 剩余:324s
2025-09-08 16:44:12 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000068] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:12 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000063] 批量插入 1 条新记录
2025-09-08 16:44:12 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000063] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:12 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000063] 完成，耗时: 1.59s，记录: 1
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000065] 批量插入 1 条新记录
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000065] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000065] 完成，耗时: 1.71s，记录: 1
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 51/500 (10.2%) | 成功:51 失败:0 | 耗时:37s 剩余:322s
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000069] 开始同步
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 52/500 (10.4%) | 成功:52 失败:0 | 耗时:37s 剩余:321s
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000066] 批量插入 1 条新记录
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000066] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000066] 完成，耗时: 1.73s，记录: 1
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000069] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000068] 批量插入 1 条新记录
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000068] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:13 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000068] 完成，耗时: 1.43s，记录: 1
2025-09-08 16:44:14 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000070] 开始同步
2025-09-08 16:44:14 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 53/500 (10.6%) | 成功:53 失败:0 | 耗时:38s 剩余:320s
2025-09-08 16:44:14 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000070] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:14 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 54/500 (10.8%) | 成功:54 失败:0 | 耗时:38s 剩余:318s
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000069] 批量插入 1 条新记录
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000069] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000069] 完成，耗时: 1.54s，记录: 1
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000078] 开始同步
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000078] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000070] 批量插入 1 条新记录
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000070] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000070] 完成，耗时: 1.49s，记录: 1
2025-09-08 16:44:15 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 55/500 (11.0%) | 成功:55 失败:0 | 耗时:39s 剩余:319s
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000088] 开始同步
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000089] 开始同步
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000088] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000090] 开始同步
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000089] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 56/500 (11.2%) | 成功:56 失败:0 | 耗时:40s 剩余:320s
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000078] 批量插入 1 条新记录
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000078] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:16 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000078] 完成，耗时: 1.59s，记录: 1
2025-09-08 16:44:17 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000090] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:17 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 57/500 (11.4%) | 成功:57 失败:0 | 耗时:41s 剩余:317s
2025-09-08 16:44:17 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000096] 开始同步
2025-09-08 16:44:17 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000096] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 58/500 (11.6%) | 成功:58 失败:0 | 耗时:42s 剩余:316s
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000088] 批量插入 1 条新记录
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000089] 批量插入 1 条新记录
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000088] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000089] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000088] 完成，耗时: 1.65s，记录: 1
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000089] 完成，耗时: 1.42s，记录: 1
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000090] 批量插入 1 条新记录
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000090] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000090] 完成，耗时: 1.57s，记录: 1
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 59/500 (11.8%) | 成功:59 失败:0 | 耗时:42s 剩余:314s
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000099] 开始同步
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000099] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000096] 批量插入 1 条新记录
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000096] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:18 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000096] 完成，耗时: 1.56s，记录: 1
2025-09-08 16:44:19 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 60/500 (12.0%) | 成功:60 失败:0 | 耗时:43s 剩余:312s
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000100] 开始同步
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000099] 批量插入 1 条新记录
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000099] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000099] 完成，耗时: 1.53s，记录: 1
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000150] 开始同步
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000151] 开始同步
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000100] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000150] 使用数据库最新日期后一天作为开始日期: 20230428
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000151] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 61/500 (12.2%) | 成功:61 失败:0 | 耗时:44s 剩余:317s
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000150] 未获取到 20230428 至 20250908 的历史数据
2025-09-08 16:44:20 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000150] 完成，耗时: 0.61s，记录: 0
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 62/500 (12.4%) | 成功:62 失败:0 | 耗时:45s 剩余:315s
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000153] 开始同步
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000100] 批量插入 1 条新记录
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000100] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000100] 完成，耗时: 1.52s，记录: 1
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 63/500 (12.6%) | 成功:63 失败:0 | 耗时:45s 剩余:313s
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000153] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000151] 批量插入 1 条新记录
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000151] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000151] 完成，耗时: 1.56s，记录: 1
2025-09-08 16:44:21 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000155] 开始同步
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000155] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 64/500 (12.8%) | 成功:64 失败:0 | 耗时:46s 剩余:311s
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 65/500 (13.0%) | 成功:65 失败:0 | 耗时:46s 剩余:309s
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000156] 开始同步
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000157] 开始同步
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000153] 批量插入 1 条新记录
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000153] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000153] 完成，耗时: 1.36s，记录: 1
2025-09-08 16:44:22 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000156] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000158] 开始同步
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000157] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000155] 批量插入 1 条新记录
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000155] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000155] 完成，耗时: 1.44s，记录: 1
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 66/500 (13.2%) | 成功:66 失败:0 | 耗时:47s 剩余:307s
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000158] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 67/500 (13.4%) | 成功:67 失败:0 | 耗时:47s 剩余:305s
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000156] 批量插入 1 条新记录
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000156] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:23 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000156] 完成，耗时: 1.25s，记录: 1
2025-09-08 16:44:24 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 68/500 (13.6%) | 成功:68 失败:0 | 耗时:48s 剩余:303s
2025-09-08 16:44:24 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000157] 批量插入 1 条新记录
2025-09-08 16:44:24 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000157] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:24 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000157] 完成，耗时: 1.32s，记录: 1
2025-09-08 16:44:24 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000158] 批量插入 1 条新记录
2025-09-08 16:44:24 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000158] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:24 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000158] 完成，耗时: 1.38s，记录: 1
2025-09-08 16:44:25 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000159] 开始同步
2025-09-08 16:44:25 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000166] 开始同步
2025-09-08 16:44:25 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000159] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:25 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000301] 开始同步
2025-09-08 16:44:25 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000166] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:26 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000301] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:26 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:175 - 进度 69/500 (13.8%) | 成功:69 失败:0 | 耗时:50s 剩余:311s
2025-09-08 16:44:26 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000333] 开始同步
2025-09-08 16:44:26 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000333] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:26 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000338] 开始同步
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000338] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000159] 批量插入 1 条新记录
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000159] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000159] 完成，耗时: 2.24s，记录: 1
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000166] 批量插入 1 条新记录
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000166] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000166] 完成，耗时: 2.25s，记录: 1
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000301] 批量插入 1 条新记录
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000301] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:27 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000301] 完成，耗时: 2.16s，记录: 1
2025-09-08 16:44:28 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000333] 批量插入 1 条新记录
2025-09-08 16:44:28 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000333] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:28 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000333] 完成，耗时: 1.89s，记录: 1
2025-09-08 16:44:28 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000400] 开始同步
2025-09-08 16:44:29 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000338] 批量插入 1 条新记录
2025-09-08 16:44:29 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000338] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:29 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000338] 完成，耗时: 2.30s，记录: 1
2025-09-08 16:44:29 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000400] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:29 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000401] 开始同步
2025-09-08 16:44:29 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000401] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:29 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000402] 开始同步
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000402] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000400] 批量插入 1 条新记录
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000400] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000400] 完成，耗时: 1.32s，记录: 1
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000403] 开始同步
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000404] 开始同步
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000401] 批量插入 1 条新记录
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000401] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:30 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000401] 完成，耗时: 1.51s，记录: 1
2025-09-08 16:44:31 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000403] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:31 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000404] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:31 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000402] 批量插入 1 条新记录
2025-09-08 16:44:31 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000402] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:31 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000402] 完成，耗时: 1.56s，记录: 1
2025-09-08 16:44:32 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000403] 批量插入 1 条新记录
2025-09-08 16:44:32 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000403] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:32 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000403] 完成，耗时: 1.60s，记录: 1
2025-09-08 16:44:32 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000404] 批量插入 1 条新记录
2025-09-08 16:44:32 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000404] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:44:32 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000404] 完成，耗时: 1.59s，记录: 1
2025-09-08 16:44:32 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000405] 开始同步
2025-09-08 16:44:32 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000405] 使用数据库最新日期后一天作为开始日期: 20030426
2025-09-08 16:44:33 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000405] 未获取到 20030426 至 20250908 的历史数据
2025-09-08 16:44:33 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000405] 完成，耗时: 0.72s，记录: 0
2025-09-08 16:44:33 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000406] 开始同步
2025-09-08 16:44:33 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000406] 使用数据库最新日期后一天作为开始日期: 20060407
2025-09-08 16:44:33 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000407] 开始同步
2025-09-08 16:44:34 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000408] 开始同步
2025-09-08 16:44:34 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000407] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:34 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000406] 未获取到 20060407 至 20250908 的历史数据
2025-09-08 16:44:34 | INFO     | core.sync.sync_hist_all:process_symbol:112 - [000406] 完成，耗时: 0.72s，记录: 0
2025-09-08 16:44:34 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000408] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:34 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000409] 开始同步
2025-09-08 16:44:35 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000409] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:44:35 | INFO     | core.sync.sync_hist_all:process_symbol:99 - [000410] 开始同步
2025-09-08 16:53:51 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:26 - 开始同步历史数据，结束日期: 2025-09-08, 复权: hfq, 并发: 5
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:42 - 股票代码: 5746, 已有任务: 5746
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:59 - 新增任务: 0
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:86 - 待处理任务: 500
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000156] 开始同步
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000157] 开始同步
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000158] 开始同步
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000159] 开始同步
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000166] 开始同步
2025-09-08 16:53:52 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000156] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000166] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000157] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000158] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:53 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000159] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000156] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000156] 失败，耗时: 0.99s，错误: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000159] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000159] 失败，耗时: 1.11s，错误: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000166] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000157] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000166] 失败，耗时: 1.20s，错误: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000157] 失败，耗时: 1.21s，错误: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000158] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:53 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000158] 失败，耗时: 1.21s，错误: 'zygcfx'
2025-09-08 16:53:54 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000301] 开始同步
2025-09-08 16:53:55 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000301] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:55 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000333] 开始同步
2025-09-08 16:53:55 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000333] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:55 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000338] 开始同步
2025-09-08 16:53:55 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000338] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:55 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000400] 开始同步
2025-09-08 16:53:56 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000333] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:56 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000333] 失败，耗时: 0.74s，错误: 'zygcfx'
2025-09-08 16:53:56 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000301] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:56 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000301] 失败，耗时: 1.30s，错误: 'zygcfx'
2025-09-08 16:53:56 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000401] 开始同步
2025-09-08 16:53:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000400] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:56 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000338] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:56 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000338] 失败，耗时: 0.79s，错误: 'zygcfx'
2025-09-08 16:53:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000401] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:56 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000400] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:56 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000400] 失败，耗时: 0.89s，错误: 'zygcfx'
2025-09-08 16:53:57 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000402] 开始同步
2025-09-08 16:53:57 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000401] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:57 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000401] 失败，耗时: 1.02s，错误: 'zygcfx'
2025-09-08 16:53:57 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000402] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:58 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000402] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:58 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000402] 失败，耗时: 0.88s，错误: 'zygcfx'
2025-09-08 16:53:58 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000403] 开始同步
2025-09-08 16:53:58 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000404] 开始同步
2025-09-08 16:53:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000403] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:58 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000404] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:53:59 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000403] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:59 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000403] 失败，耗时: 0.78s，错误: 'zygcfx'
2025-09-08 16:53:59 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000405] 开始同步
2025-09-08 16:53:59 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000404] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:53:59 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000404] 失败，耗时: 0.74s，错误: 'zygcfx'
2025-09-08 16:53:59 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000406] 开始同步
2025-09-08 16:53:59 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000405] 使用数据库最新日期后一天作为开始日期: 20030426
2025-09-08 16:53:59 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000406] 使用数据库最新日期后一天作为开始日期: 20060407
2025-09-08 16:53:59 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000405] 未获取到 20030426 至 20250908 的历史数据
2025-09-08 16:54:00 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000407] 开始同步
2025-09-08 16:54:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000406] 未获取到 20060407 至 20250908 的历史数据
2025-09-08 16:54:00 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000405] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:00 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000405] 失败，耗时: 1.14s，错误: 'zygcfx'
2025-09-08 16:54:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000407] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:54:00 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000406] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:00 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000406] 失败，耗时: 1.15s，错误: 'zygcfx'
2025-09-08 16:54:00 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000408] 开始同步
2025-09-08 16:54:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000408] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:54:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000407] 批量插入 1 条新记录
2025-09-08 16:54:01 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000407] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:54:01 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000409] 开始同步
2025-09-08 16:54:02 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000407] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:02 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000407] 失败，耗时: 2.04s，错误: 'zygcfx'
2025-09-08 16:54:02 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000409] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:54:02 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000410] 开始同步
2025-09-08 16:54:02 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000408] 批量插入 1 条新记录
2025-09-08 16:54:02 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000408] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:54:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000410] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:54:03 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000411] 开始同步
2025-09-08 16:54:03 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000408] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:03 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000408] 失败，耗时: 2.33s，错误: 'zygcfx'
2025-09-08 16:54:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000411] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:54:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000409] 批量插入 1 条新记录
2025-09-08 16:54:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000409] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:54:04 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000409] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:04 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000410] 批量插入 1 条新记录
2025-09-08 16:54:04 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000409] 失败，耗时: 2.44s，错误: 'zygcfx'
2025-09-08 16:54:04 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000410] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:54:04 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000412] 开始同步
2025-09-08 16:54:04 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000410] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:04 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000410] 失败，耗时: 1.87s，错误: 'zygcfx'
2025-09-08 16:54:04 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000412] 使用数据库最新日期后一天作为开始日期: 20030426
2025-09-08 16:54:04 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:139 - [000411] 批量插入 1 条新记录
2025-09-08 16:54:04 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:153 - [000411] 成功处理 1 条历史记录 (新增: 1, 更新: 0), 调整类型: hfq
2025-09-08 16:54:04 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000413] 开始同步
2025-09-08 16:54:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000412] 未获取到 20030426 至 20250908 的历史数据
2025-09-08 16:54:05 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000411] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:05 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000411] 失败，耗时: 2.02s，错误: 'zygcfx'
2025-09-08 16:54:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000413] 使用数据库最新日期后一天作为开始日期: 20240815
2025-09-08 16:54:05 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000415] 开始同步
2025-09-08 16:54:05 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000412] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:05 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000412] 失败，耗时: 1.22s，错误: 'zygcfx'
2025-09-08 16:54:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:70 - [000413] 未获取到 20240815 至 20250908 的历史数据
2025-09-08 16:54:05 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000415] 使用数据库最新日期后一天作为开始日期: 20250906
2025-09-08 16:54:06 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000413] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:06 | ERROR    | core.sync.sync_hist_all:process_symbol:123 - [000413] 失败，耗时: 1.38s，错误: 'zygcfx'
2025-09-08 16:54:06 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000416] 开始同步
2025-09-08 16:54:06 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:45 - [000416] 使用数据库最新日期后一天作为开始日期: 20240425
2025-09-08 16:54:54 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:26 - 开始同步历史数据，结束日期: 2025-09-08, 复权: hfq, 并发: 1
2025-09-08 16:54:55 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:42 - 股票代码: 5746, 已有任务: 5746
2025-09-08 16:54:55 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:59 - 新增任务: 0
2025-09-08 16:54:55 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:86 - 待处理任务: 500
2025-09-08 16:54:56 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000156] 开始同步
2025-09-08 16:54:56 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000156] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:54:56 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000156] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:54:56 | ERROR    | core.sync.sync_hist_all:process_symbol:125 - [000156] 失败，耗时: 0.80s，错误: 'zygcfx'
2025-09-08 16:54:59 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000157] 开始同步
2025-09-08 16:54:59 | INFO     | core.sync.sync_hist_all:sync_stock_zh_a_hist_all:201 - 进度 1/500 (0.2%) | 成功:0 失败:1 | 耗时:4s 剩余:1907s
2025-09-08 16:55:00 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000157] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:55:00 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000157] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:55:00 | ERROR    | core.sync.sync_hist_all:process_symbol:125 - [000157] 失败，耗时: 1.10s，错误: 'zygcfx'
2025-09-08 16:55:02 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000158] 开始同步
2025-09-08 16:55:03 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000158] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:55:03 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000158] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:55:03 | ERROR    | core.sync.sync_hist_all:process_symbol:125 - [000158] 失败，耗时: 1.06s，错误: 'zygcfx'
2025-09-08 16:55:06 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000159] 开始同步
2025-09-08 16:55:06 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000159] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:55:07 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000159] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:55:07 | ERROR    | core.sync.sync_hist_all:process_symbol:125 - [000159] 失败，耗时: 1.06s，错误: 'zygcfx'
2025-09-08 16:55:09 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000166] 开始同步
2025-09-08 16:55:10 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000166] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:55:10 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000166] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:55:10 | ERROR    | core.sync.sync_hist_all:process_symbol:125 - [000166] 失败，耗时: 1.17s，错误: 'zygcfx'
2025-09-08 16:55:12 | INFO     | core.sync.sync_hist_all:process_symbol:100 - [000301] 开始同步
2025-09-08 16:55:13 | INFO     | core.sync.sync_hist:sync_stock_zh_a_hist:35 - [000301] 最新数据日期 2025-09-08 已超过或等于结束日期 2025-09-08，跳过同步
2025-09-08 16:55:13 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [000301] 获取主营构成数据失败: 'zygcfx'
2025-09-08 16:55:13 | ERROR    | core.sync.sync_hist_all:process_symbol:125 - [000301] 失败，耗时: 0.72s，错误: 'zygcfx'
2025-09-08 16:58:59 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:112 - [688041] 获取主营构成数据失败: 'zygcfx'
2025-09-08 17:06:08 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:56 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:06:08 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH688041] 获取到 73 条主营构成数据
2025-09-08 17:06:10 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:141 - [SH688041] 数据库操作失败: (mysql.connector.errors.DatabaseError) 1366 (HY000): Incorrect integer value: '高端处理器' for column 'main_composition' at row 1
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-09-08 17:06:10 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:142 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Incorrect integer value: '高端处理器' for column 'main_composition' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.DatabaseError: 1366 (HY000): Incorrect integer value: '高端处理器' for column 'main_composition' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.DatabaseError: (mysql.connector.errors.DatabaseError) 1366 (HY000): Incorrect integer value: '高端处理器' for column 'main_composition' at row 1
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/4xp6)

2025-09-08 17:06:10 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:150 - [SH688041] 获取主营构成数据失败: (mysql.connector.errors.DatabaseError) 1366 (HY000): Incorrect integer value: '高端处理器' for column 'main_composition' at row 1
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/4xp6)
2025-09-08 17:06:10 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:151 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Incorrect integer value: '高端处理器' for column 'main_composition' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.DatabaseError: 1366 (HY000): Incorrect integer value: '高端处理器' for column 'main_composition' at row 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.DatabaseError: (mysql.connector.errors.DatabaseError) 1366 (HY000): Incorrect integer value: '高端处理器' for column 'main_composition' at row 1
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/4xp6)

2025-09-08 17:07:51 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:56 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:07:51 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH688041] 获取到 73 条主营构成数据
2025-09-08 17:07:52 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:141 - [SH688041] 数据库操作失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:07:52 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:142 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:07:52 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:150 - [SH688041] 获取主营构成数据失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:07:52 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:151 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:09:29 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:56 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:09:29 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH688041] 获取到 73 条主营构成数据
2025-09-08 17:09:29 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:141 - [SH688041] 数据库操作失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:09:29 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:142 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:09:29 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:150 - [SH688041] 获取主营构成数据失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:09:29 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:151 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:09:52 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:56 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:09:52 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH688041] 获取到 73 条主营构成数据
2025-09-08 17:09:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:141 - [SH688041] 数据库操作失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:09:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:142 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:09:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:150 - [SH688041] 获取主营构成数据失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:09:53 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:151 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:10:29 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:56 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:10:30 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH688041] 获取到 73 条主营构成数据
2025-09-08 17:10:31 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:137 - [SH688041] 成功同步 73 条主营构成数据
2025-09-08 17:15:09 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:56 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:15:10 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH688041] 获取到 73 条主营构成数据
2025-09-08 17:15:11 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:141 - [SH688041] 数据库操作失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类-高端处理器' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:15:11 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:142 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041-2025-06-30-按产品分类-高端处理器' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类-高端处理器' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类-高端处理器' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:15:11 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:150 - [SH688041] 获取主营构成数据失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类-高端处理器' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:15:11 | ERROR    | core.sync.sync_business_composition:sync_stock_business_composition:151 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041-2025-06-30-按产品分类-高端处理器' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类-高端处理器' for key 'stock_business_composition.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_business_composition.py", line 136, in sync_stock_business_composition
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041-2025-06-30-按产品分类-高端处理器' for key 'stock_business_composition.PRIMARY'
[SQL: INSERT INTO stock_business_composition (symbol, report_date, category_type, main_composition, main_income, income_ratio, main_cost, cost_ratio, main_profit, profit_ratio, gross_margin) VALUES (%(symbol)s, %(report_date)s, %(category_type)s, %(main_composition)s, %(main_income)s, %(income_ratio)s, %(main_cost)s, %(cost_ratio)s, %(main_profit)s, %(profit_ratio)s, %(gross_margin)s)]
[parameters: [{'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 5449573753.52, 'income_ratio': 0.997317, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3271907734.8, 'profit_ratio': 0.995539, 'gross_margin': 0.600397}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按产品分类', 'main_composition': '其他(补充)', 'main_income': 14661303.63, 'income_ratio': 0.002683, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 14661303.63, 'profit_ratio': 0.004461, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2025, 6, 30), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 5464235057.15, 'income_ratio': 1.0, 'main_cost': 2177666018.72, 'cost_ratio': 1.0, 'main_profit': 3286569038.43, 'profit_ratio': 1.0, 'gross_margin': 0.601469}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路产品', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '', 'main_composition': '集成电路技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '高端处理器', 'main_income': 9134299079.32, 'income_ratio': 0.99696, 'main_cost': 3315922378.41, 'cost_ratio': 0.997567, 'main_profit': 5818376700.91, 'profit_ratio': 0.996615, 'gross_margin': 0.636981}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按产品分类', 'main_composition': '技术服务', 'main_income': 27849056.6, 'income_ratio': 0.00304, 'main_cost': 8086970.8, 'cost_ratio': 0.002433, 'main_profit': 19762085.8, 'profit_ratio': 0.003385, 'gross_margin': 0.709614}, {'symbol': '688041', 'report_date': datetime.date(2024, 12, 31), 'category_type': '按地区分类', 'main_composition': '境内(含港澳台地区)', 'main_income': 9162148135.92, 'income_ratio': 1.0, 'main_cost': 3324009349.21, 'cost_ratio': 1.0, 'main_profit': 5838138786.71, 'profit_ratio': 1.0, 'gross_margin': 0.637202}  ... displaying 10 of 73 total bound parameter sets ...  {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '华北', 'main_income': 47539900.0, 'income_ratio': 0.985254, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}, {'symbol': '688041', 'report_date': datetime.date(2018, 12, 31), 'category_type': '按地区分类', 'main_composition': '其他(补充)', 'main_income': 711500.0, 'income_ratio': 0.014746, 'main_cost': 0.0, 'cost_ratio': 0.0, 'main_profit': 0.0, 'profit_ratio': 0.0, 'gross_margin': 0.0}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:16:29 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:56 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:16:30 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH688041] 获取到 73 条主营构成数据
2025-09-08 17:16:31 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:137 - [SH688041] 成功同步 73 条主营构成数据
2025-09-08 17:17:08 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:56 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:17:09 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:61 - [SH688041] 获取到 73 条主营构成数据
2025-09-08 17:17:10 | INFO     | core.sync.sync_business_composition:sync_stock_business_composition:139 - [SH688041] 成功同步 73 条主营构成数据
2025-09-08 17:17:39 | INFO     | core.sync.sync_stock_news:sync_stock_news:26 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:17:40 | INFO     | core.sync.sync_stock_news:sync_stock_news:31 - [SH688041] 获取到 96 条新闻数据
2025-09-08 17:18:05 | INFO     | core.sync.sync_stock_news:sync_stock_news:86 - [SH688041] 成功同步 96 条新闻数据
2025-09-08 17:19:44 | INFO     | core.sync.sync_stock_news:sync_stock_news:26 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:19:44 | INFO     | core.sync.sync_stock_news:sync_stock_news:31 - [SH688041] 获取到 96 条新闻数据
2025-09-08 17:19:45 | INFO     | core.sync.sync_stock_news:sync_stock_news:91 - [SH688041] 成功同步 96 条新闻数据
2025-09-08 17:20:52 | INFO     | core.sync.sync_stock_news:sync_stock_news:26 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:20:53 | INFO     | core.sync.sync_stock_news:sync_stock_news:31 - [SH688041] 获取到 96 条新闻数据
2025-09-08 17:20:53 | ERROR    | core.sync.sync_stock_news:sync_stock_news:93 - [SH688041] 数据库操作失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'
[SQL: INSERT INTO stock_news_data (symbol, keyword, title, content, publish_time, source, link) VALUES (%(symbol)s, %(keyword)s, %(title)s, %(content)s, %(publish_time)s, %(source)s, %(link)s)]
[parameters: [{'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：2025年半年度净利润约12.01亿元，同比增加40.78%', 'content': '海光信息（SH 688041，收盘价：142.46元）8月5日晚间发布半年度业绩报告称，2025年上半年营业收入约54.64', 'publish_time': Timestamp('2025-08-05 18:40:42'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508053476613180.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：约14.38亿股限售股8月12日解禁', 'content': '海光信息（SH 688041，收盘价：142.58元）8月4日晚间发布公告称，公司限售股份约14.38亿股将于2025', 'publish_time': Timestamp('2025-08-04 18:52:07'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508043475473670.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：将向产业生态伙伴开放CPU能力', 'content': '广网北京9月5日消息（记者齐智颖实习记者刘子瑶）央广财经记者从海光信息（688041.SH方面获悉，该公司将开放CPU', 'publish_time': Timestamp('2025-09-05 18:10:57'), 'source': '央广财经', 'link': 'http://finance.eastmoney.com/a/202509053506239525.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '沪市上半年丨消费筑基、科技引领！沪市公司净利增长1.1%', 'content': '海光信息（688041.SH）的高端处理器产品涉及的新兴人工智能大模型产业逐渐增多，带动上半年净利润首次突破10亿元。', 'publish_time': Timestamp('2025-09-01 09:07:52'), 'source': '中国经营报', 'link': 'http://finance.eastmoney.com/a/202509013500586366.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '沪指续创十年新高，创业板突破2700点！稀土永磁、白酒、AI算力等板块领涨', 'content': '（688041.SH）、中科曙光（603019.SH）、新易盛（300502.SZ）均涨超8%。', 'publish_time': Timestamp('2025-08-25 13:29:48'), 'source': '红星资本局', 'link': 'http://finance.eastmoney.com/a/202508253493440392.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '十年扎根高端计算，海光C86迈进“可选、可信、可用”新时代', 'content': '海光信息（688041.SH），第二个十年悄然开启。而起手式，或许可以从一场活动看出端倪。', 'publish_time': Timestamp('2025-08-27 11:58:46'), 'source': '时代周报', 'link': 'http://finance.eastmoney.com/a/202508273496141550.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': 'A股五年变迁：电子板块市值“逼宫”银行 能否跑出中国版“英伟达”？', 'content': '）单日暴涨20%、市值激增近千亿元，一举超越多家头部金融股；海光信息（688041', 'publish_time': Timestamp('2025-08-24 16:39:19'), 'source': '第一财经', 'link': 'http://finance.eastmoney.com/a/202508243492773762.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息拟1160亿元换股吸收合并中科曙光 换股定价高于现金选择权引发股东“吐槽”', 'content': '6月9日，国内算力产业最大合并案落锤，海光信息（SH688041，股价135.50元，市值3149亿元）拟1160亿元换股吸收合并中科曙光', 'publish_time': Timestamp('2025-06-11 21:40:08'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202506113428019075.html'}  ... displaying 10 of 96 total bound parameter sets ...  {'symbol': '688041', 'keyword': 'SH688041', 'title': '多家外资机构加入看多中国股市阵营，科创综指ETF天弘（589860）早盘飘红，相关联接基金正式获批', 'content': '是绝对重仓的方向，在电子板块的重仓股包括国产算力芯片龙头海光信息（688041.SH）和寒武纪-U（688256.SH），', 'publish_time': Timestamp('2025-03-12 13:10:55'), 'source': '21世纪经济报道', 'link': 'http://finance.eastmoney.com/a/202503123343521331.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '券商评级一周速览：159只个股获券商关注，赢合科技目标涨幅达122.85%', 'content': '看，有29只个股获得多家券商关注，券商关注数量排名居前的个股是海光信息（688041.SH）、比亚迪', 'publish_time': Timestamp('2025-03-09 12:02:36'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202503093340457919.html'}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:20:53 | ERROR    | core.sync.sync_stock_news:sync_stock_news:94 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041' for key 'stock_news_data.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_stock_news.py", line 88, in sync_stock_news
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'
[SQL: INSERT INTO stock_news_data (symbol, keyword, title, content, publish_time, source, link) VALUES (%(symbol)s, %(keyword)s, %(title)s, %(content)s, %(publish_time)s, %(source)s, %(link)s)]
[parameters: [{'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：2025年半年度净利润约12.01亿元，同比增加40.78%', 'content': '海光信息（SH 688041，收盘价：142.46元）8月5日晚间发布半年度业绩报告称，2025年上半年营业收入约54.64', 'publish_time': Timestamp('2025-08-05 18:40:42'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508053476613180.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：约14.38亿股限售股8月12日解禁', 'content': '海光信息（SH 688041，收盘价：142.58元）8月4日晚间发布公告称，公司限售股份约14.38亿股将于2025', 'publish_time': Timestamp('2025-08-04 18:52:07'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508043475473670.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：将向产业生态伙伴开放CPU能力', 'content': '广网北京9月5日消息（记者齐智颖实习记者刘子瑶）央广财经记者从海光信息（688041.SH方面获悉，该公司将开放CPU', 'publish_time': Timestamp('2025-09-05 18:10:57'), 'source': '央广财经', 'link': 'http://finance.eastmoney.com/a/202509053506239525.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '沪市上半年丨消费筑基、科技引领！沪市公司净利增长1.1%', 'content': '海光信息（688041.SH）的高端处理器产品涉及的新兴人工智能大模型产业逐渐增多，带动上半年净利润首次突破10亿元。', 'publish_time': Timestamp('2025-09-01 09:07:52'), 'source': '中国经营报', 'link': 'http://finance.eastmoney.com/a/202509013500586366.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '沪指续创十年新高，创业板突破2700点！稀土永磁、白酒、AI算力等板块领涨', 'content': '（688041.SH）、中科曙光（603019.SH）、新易盛（300502.SZ）均涨超8%。', 'publish_time': Timestamp('2025-08-25 13:29:48'), 'source': '红星资本局', 'link': 'http://finance.eastmoney.com/a/202508253493440392.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '十年扎根高端计算，海光C86迈进“可选、可信、可用”新时代', 'content': '海光信息（688041.SH），第二个十年悄然开启。而起手式，或许可以从一场活动看出端倪。', 'publish_time': Timestamp('2025-08-27 11:58:46'), 'source': '时代周报', 'link': 'http://finance.eastmoney.com/a/202508273496141550.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': 'A股五年变迁：电子板块市值“逼宫”银行 能否跑出中国版“英伟达”？', 'content': '）单日暴涨20%、市值激增近千亿元，一举超越多家头部金融股；海光信息（688041', 'publish_time': Timestamp('2025-08-24 16:39:19'), 'source': '第一财经', 'link': 'http://finance.eastmoney.com/a/202508243492773762.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息拟1160亿元换股吸收合并中科曙光 换股定价高于现金选择权引发股东“吐槽”', 'content': '6月9日，国内算力产业最大合并案落锤，海光信息（SH688041，股价135.50元，市值3149亿元）拟1160亿元换股吸收合并中科曙光', 'publish_time': Timestamp('2025-06-11 21:40:08'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202506113428019075.html'}  ... displaying 10 of 96 total bound parameter sets ...  {'symbol': '688041', 'keyword': 'SH688041', 'title': '多家外资机构加入看多中国股市阵营，科创综指ETF天弘（589860）早盘飘红，相关联接基金正式获批', 'content': '是绝对重仓的方向，在电子板块的重仓股包括国产算力芯片龙头海光信息（688041.SH）和寒武纪-U（688256.SH），', 'publish_time': Timestamp('2025-03-12 13:10:55'), 'source': '21世纪经济报道', 'link': 'http://finance.eastmoney.com/a/202503123343521331.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '券商评级一周速览：159只个股获券商关注，赢合科技目标涨幅达122.85%', 'content': '看，有29只个股获得多家券商关注，券商关注数量排名居前的个股是海光信息（688041.SH）、比亚迪', 'publish_time': Timestamp('2025-03-09 12:02:36'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202503093340457919.html'}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:20:53 | ERROR    | core.sync.sync_stock_news:sync_stock_news:102 - [SH688041] 获取新闻数据失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'
[SQL: INSERT INTO stock_news_data (symbol, keyword, title, content, publish_time, source, link) VALUES (%(symbol)s, %(keyword)s, %(title)s, %(content)s, %(publish_time)s, %(source)s, %(link)s)]
[parameters: [{'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：2025年半年度净利润约12.01亿元，同比增加40.78%', 'content': '海光信息（SH 688041，收盘价：142.46元）8月5日晚间发布半年度业绩报告称，2025年上半年营业收入约54.64', 'publish_time': Timestamp('2025-08-05 18:40:42'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508053476613180.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：约14.38亿股限售股8月12日解禁', 'content': '海光信息（SH 688041，收盘价：142.58元）8月4日晚间发布公告称，公司限售股份约14.38亿股将于2025', 'publish_time': Timestamp('2025-08-04 18:52:07'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508043475473670.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：将向产业生态伙伴开放CPU能力', 'content': '广网北京9月5日消息（记者齐智颖实习记者刘子瑶）央广财经记者从海光信息（688041.SH方面获悉，该公司将开放CPU', 'publish_time': Timestamp('2025-09-05 18:10:57'), 'source': '央广财经', 'link': 'http://finance.eastmoney.com/a/202509053506239525.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '沪市上半年丨消费筑基、科技引领！沪市公司净利增长1.1%', 'content': '海光信息（688041.SH）的高端处理器产品涉及的新兴人工智能大模型产业逐渐增多，带动上半年净利润首次突破10亿元。', 'publish_time': Timestamp('2025-09-01 09:07:52'), 'source': '中国经营报', 'link': 'http://finance.eastmoney.com/a/202509013500586366.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '沪指续创十年新高，创业板突破2700点！稀土永磁、白酒、AI算力等板块领涨', 'content': '（688041.SH）、中科曙光（603019.SH）、新易盛（300502.SZ）均涨超8%。', 'publish_time': Timestamp('2025-08-25 13:29:48'), 'source': '红星资本局', 'link': 'http://finance.eastmoney.com/a/202508253493440392.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '十年扎根高端计算，海光C86迈进“可选、可信、可用”新时代', 'content': '海光信息（688041.SH），第二个十年悄然开启。而起手式，或许可以从一场活动看出端倪。', 'publish_time': Timestamp('2025-08-27 11:58:46'), 'source': '时代周报', 'link': 'http://finance.eastmoney.com/a/202508273496141550.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': 'A股五年变迁：电子板块市值“逼宫”银行 能否跑出中国版“英伟达”？', 'content': '）单日暴涨20%、市值激增近千亿元，一举超越多家头部金融股；海光信息（688041', 'publish_time': Timestamp('2025-08-24 16:39:19'), 'source': '第一财经', 'link': 'http://finance.eastmoney.com/a/202508243492773762.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息拟1160亿元换股吸收合并中科曙光 换股定价高于现金选择权引发股东“吐槽”', 'content': '6月9日，国内算力产业最大合并案落锤，海光信息（SH688041，股价135.50元，市值3149亿元）拟1160亿元换股吸收合并中科曙光', 'publish_time': Timestamp('2025-06-11 21:40:08'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202506113428019075.html'}  ... displaying 10 of 96 total bound parameter sets ...  {'symbol': '688041', 'keyword': 'SH688041', 'title': '多家外资机构加入看多中国股市阵营，科创综指ETF天弘（589860）早盘飘红，相关联接基金正式获批', 'content': '是绝对重仓的方向，在电子板块的重仓股包括国产算力芯片龙头海光信息（688041.SH）和寒武纪-U（688256.SH），', 'publish_time': Timestamp('2025-03-12 13:10:55'), 'source': '21世纪经济报道', 'link': 'http://finance.eastmoney.com/a/202503123343521331.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '券商评级一周速览：159只个股获券商关注，赢合科技目标涨幅达122.85%', 'content': '看，有29只个股获得多家券商关注，券商关注数量排名居前的个股是海光信息（688041.SH）、比亚迪', 'publish_time': Timestamp('2025-03-09 12:02:36'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202503093340457919.html'}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:20:53 | ERROR    | core.sync.sync_stock_news:sync_stock_news:103 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041' for key 'stock_news_data.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_stock_news.py", line 88, in sync_stock_news
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1936, in _exec_single_context
    self.dialect.do_executemany(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 948, in do_executemany
    cursor.executemany(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 473, in executemany
    return self.execute(cast(str, stmt))
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'
[SQL: INSERT INTO stock_news_data (symbol, keyword, title, content, publish_time, source, link) VALUES (%(symbol)s, %(keyword)s, %(title)s, %(content)s, %(publish_time)s, %(source)s, %(link)s)]
[parameters: [{'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：2025年半年度净利润约12.01亿元，同比增加40.78%', 'content': '海光信息（SH 688041，收盘价：142.46元）8月5日晚间发布半年度业绩报告称，2025年上半年营业收入约54.64', 'publish_time': Timestamp('2025-08-05 18:40:42'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508053476613180.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：约14.38亿股限售股8月12日解禁', 'content': '海光信息（SH 688041，收盘价：142.58元）8月4日晚间发布公告称，公司限售股份约14.38亿股将于2025', 'publish_time': Timestamp('2025-08-04 18:52:07'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508043475473670.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：将向产业生态伙伴开放CPU能力', 'content': '广网北京9月5日消息（记者齐智颖实习记者刘子瑶）央广财经记者从海光信息（688041.SH方面获悉，该公司将开放CPU', 'publish_time': Timestamp('2025-09-05 18:10:57'), 'source': '央广财经', 'link': 'http://finance.eastmoney.com/a/202509053506239525.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '沪市上半年丨消费筑基、科技引领！沪市公司净利增长1.1%', 'content': '海光信息（688041.SH）的高端处理器产品涉及的新兴人工智能大模型产业逐渐增多，带动上半年净利润首次突破10亿元。', 'publish_time': Timestamp('2025-09-01 09:07:52'), 'source': '中国经营报', 'link': 'http://finance.eastmoney.com/a/202509013500586366.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '沪指续创十年新高，创业板突破2700点！稀土永磁、白酒、AI算力等板块领涨', 'content': '（688041.SH）、中科曙光（603019.SH）、新易盛（300502.SZ）均涨超8%。', 'publish_time': Timestamp('2025-08-25 13:29:48'), 'source': '红星资本局', 'link': 'http://finance.eastmoney.com/a/202508253493440392.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '十年扎根高端计算，海光C86迈进“可选、可信、可用”新时代', 'content': '海光信息（688041.SH），第二个十年悄然开启。而起手式，或许可以从一场活动看出端倪。', 'publish_time': Timestamp('2025-08-27 11:58:46'), 'source': '时代周报', 'link': 'http://finance.eastmoney.com/a/202508273496141550.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': 'A股五年变迁：电子板块市值“逼宫”银行 能否跑出中国版“英伟达”？', 'content': '）单日暴涨20%、市值激增近千亿元，一举超越多家头部金融股；海光信息（688041', 'publish_time': Timestamp('2025-08-24 16:39:19'), 'source': '第一财经', 'link': 'http://finance.eastmoney.com/a/202508243492773762.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息拟1160亿元换股吸收合并中科曙光 换股定价高于现金选择权引发股东“吐槽”', 'content': '6月9日，国内算力产业最大合并案落锤，海光信息（SH688041，股价135.50元，市值3149亿元）拟1160亿元换股吸收合并中科曙光', 'publish_time': Timestamp('2025-06-11 21:40:08'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202506113428019075.html'}  ... displaying 10 of 96 total bound parameter sets ...  {'symbol': '688041', 'keyword': 'SH688041', 'title': '多家外资机构加入看多中国股市阵营，科创综指ETF天弘（589860）早盘飘红，相关联接基金正式获批', 'content': '是绝对重仓的方向，在电子板块的重仓股包括国产算力芯片龙头海光信息（688041.SH）和寒武纪-U（688256.SH），', 'publish_time': Timestamp('2025-03-12 13:10:55'), 'source': '21世纪经济报道', 'link': 'http://finance.eastmoney.com/a/202503123343521331.html'}, {'symbol': '688041', 'keyword': 'SH688041', 'title': '券商评级一周速览：159只个股获券商关注，赢合科技目标涨幅达122.85%', 'content': '看，有29只个股获得多家券商关注，券商关注数量排名居前的个股是海光信息（688041.SH）、比亚迪', 'publish_time': Timestamp('2025-03-09 12:02:36'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202503093340457919.html'}]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:21:17 | INFO     | core.sync.sync_stock_news:sync_stock_news:26 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:21:17 | INFO     | core.sync.sync_stock_news:sync_stock_news:31 - [SH688041] 获取到 96 条新闻数据
2025-09-08 17:21:18 | ERROR    | core.sync.sync_stock_news:sync_stock_news:93 - [SH688041] 数据库操作失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'
[SQL: INSERT INTO stock_news_data (symbol, keyword, title, content, publish_time, source, link) VALUES (%(symbol)s, %(keyword)s, %(title)s, %(content)s, %(publish_time)s, %(source)s, %(link)s)]
[parameters: {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：约14.38亿股限售股8月12日解禁', 'content': '海光信息（SH 688041，收盘价：142.58元）8月4日晚间发布公告称，公司限售股份约14.38亿股将于2025', 'publish_time': Timestamp('2025-08-04 18:52:07'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508043475473670.html'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:21:18 | ERROR    | core.sync.sync_stock_news:sync_stock_news:94 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041' for key 'stock_news_data.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_stock_news.py", line 88, in sync_stock_news
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'
[SQL: INSERT INTO stock_news_data (symbol, keyword, title, content, publish_time, source, link) VALUES (%(symbol)s, %(keyword)s, %(title)s, %(content)s, %(publish_time)s, %(source)s, %(link)s)]
[parameters: {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：约14.38亿股限售股8月12日解禁', 'content': '海光信息（SH 688041，收盘价：142.58元）8月4日晚间发布公告称，公司限售股份约14.38亿股将于2025', 'publish_time': Timestamp('2025-08-04 18:52:07'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508043475473670.html'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:21:18 | ERROR    | core.sync.sync_stock_news:sync_stock_news:102 - [SH688041] 获取新闻数据失败: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'
[SQL: INSERT INTO stock_news_data (symbol, keyword, title, content, publish_time, source, link) VALUES (%(symbol)s, %(keyword)s, %(title)s, %(content)s, %(publish_time)s, %(source)s, %(link)s)]
[parameters: {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：约14.38亿股限售股8月12日解禁', 'content': '海光信息（SH 688041，收盘价：142.58元）8月4日晚间发布公告称，公司限售股份约14.38亿股将于2025', 'publish_time': Timestamp('2025-08-04 18:52:07'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508043475473670.html'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-09-08 17:21:18 | ERROR    | core.sync.sync_stock_news:sync_stock_news:103 - [SH688041] 详细错误信息:
Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
_mysql_connector.MySQLInterfaceError: Duplicate entry '688041' for key 'stock_news_data.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
mysql.connector.errors.IntegrityError: 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\wings\Documents\Github\stock_chose\packages\core\src\core\sync\sync_stock_news.py", line 88, in sync_stock_news
    db.commit()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4481, in _flush
    transaction.rollback(_capture_exception=True)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\opentelemetry\context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "D:\wings\Documents\Github\stock_chose\.venv\lib\site-packages\mysql\connector\connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
sqlalchemy.exc.IntegrityError: (mysql.connector.errors.IntegrityError) 1062 (23000): Duplicate entry '688041' for key 'stock_news_data.PRIMARY'
[SQL: INSERT INTO stock_news_data (symbol, keyword, title, content, publish_time, source, link) VALUES (%(symbol)s, %(keyword)s, %(title)s, %(content)s, %(publish_time)s, %(source)s, %(link)s)]
[parameters: {'symbol': '688041', 'keyword': 'SH688041', 'title': '海光信息：约14.38亿股限售股8月12日解禁', 'content': '海光信息（SH 688041，收盘价：142.58元）8月4日晚间发布公告称，公司限售股份约14.38亿股将于2025', 'publish_time': Timestamp('2025-08-04 18:52:07'), 'source': '每日经济新闻', 'link': 'http://finance.eastmoney.com/a/202508043475473670.html'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

2025-09-08 17:21:36 | INFO     | core.sync.sync_stock_news:sync_stock_news:26 - 股票代码已从 688041 格式化为 SH688041
2025-09-08 17:21:36 | INFO     | core.sync.sync_stock_news:sync_stock_news:31 - [SH688041] 获取到 96 条新闻数据
2025-09-08 17:21:57 | INFO     | core.sync.sync_stock_news:sync_stock_news:89 - [SH688041] 成功同步 96 条新闻数据
